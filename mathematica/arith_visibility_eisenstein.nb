(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     27302,        791]
NotebookOptionsPosition[     26167,        755]
NotebookOutlinePosition[     26524,        771]
CellTagsIndexPosition[     26481,        768]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"algnormES", ",", "ModuloES", ",", "GCDES"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"FindTuple", ",", "pCond1", ",", "pCond2"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6218548128684273`*^9, 3.6218548188918*^9}, {
  3.6219356852099533`*^9, 3.6219356858017063`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Algebraic", " ", "norm", " ", "for", " ", "the", " ", "Eisenstein", " ", 
    RowBox[{"integers", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"algnormES", "[", 
     RowBox[{"{", 
      RowBox[{"a_Integer", ",", " ", "b_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", "^", "2"}], "-", 
     RowBox[{"a", "*", "b"}], "+", 
     RowBox[{"b", "^", "2"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6218548268842382`*^9, 3.621854830287106*^9}, {
  3.621854933409816*^9, 3.621854938864038*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Modulo", " ", "operation", " ", "for", " ", "the", " ", "Eisenstein", " ", 
    RowBox[{"integers", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ModuloES", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], " ", ":=",
     "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"norm", ",", "alpha", ",", " ", "beta"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"norm", " ", "=", " ", 
        RowBox[{"algnormES", "[", 
         RowBox[{"{", 
          RowBox[{"a2", ",", "b2"}], "}"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"alpha", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a1", "*", "a2"}], "+", 
            RowBox[{"b1", "*", "b2"}], "-", 
            RowBox[{"a1", "*", "b2"}]}], ")"}], "/", "norm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"beta", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a1"}], "*", "b2"}], "+", 
            RowBox[{"b1", "*", "a2"}]}], ")"}], "/", "norm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"alpha", "*", "a2"}], "-", 
             RowBox[{"beta", "*", "b2"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"b1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"alpha", "*", "b2"}], "+", 
             RowBox[{"beta", "*", 
              RowBox[{"(", 
               RowBox[{"a2", "-", "b2"}], ")"}]}]}], ")"}]}]}], "}"}], "]"}], 
       ";"}]}], "\n", "  ", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.621854949247796*^9, 3.6218549600694933`*^9}, {
  3.6218550825448112`*^9, 3.621855110301921*^9}, {3.621937790601081*^9, 
  3.6219378415772457`*^9}, {3.621940037796545*^9, 3.621940075073263*^9}, {
  3.6221888135479097`*^9, 3.62218882821837*^9}, {3.622189011286193*^9, 
  3.622189016579138*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Simple", " ", "implementation", " ", "of", " ", "the", " ", "Euclidean", 
    " ", "algorithm", " ", "for", " ", "the", " ", "Eisenstein", " ", 
    RowBox[{"integers", "."}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"GCDES", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], " ", ":=",
     "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "y", ",", " ", "z", ",", "n"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"a1", ",", " ", "b1"}], "}"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"y", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"a2", ",", " ", "b2"}], "}"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"y", " ", "!=", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"z", " ", "=", " ", "y"}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"algnormES", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", " ", "=", " ", 
           RowBox[{"ModuloES", "[", 
            RowBox[{"x", ",", " ", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"x", " ", "=", " ", "z"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "x", "]"}]}]}], "\n", "  ", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.621855108262478*^9, 3.621855116104678*^9}, {
   3.621938035617805*^9, 3.621938035875473*^9}, {3.6219403115941057`*^9, 
   3.6219403294006157`*^9}, {3.6219403924066896`*^9, 3.621940402900422*^9}, {
   3.6219411880389147`*^9, 3.621941293908965*^9}, 3.622189042210314*^9, {
   3.62218921618972*^9, 3.6221892325557623`*^9}, {3.6221892930827*^9, 
   3.6221894127057257`*^9}}],

Cell[BoxData[
 RowBox[{"GCDES", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"21", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"27", ",", "10"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"GCDES", "[", 
     RowBox[{
      RowBox[{"Part", "[", 
       RowBox[{"#", ",", "1"}], "]"}], ",", 
      RowBox[{"Part", "[", 
       RowBox[{"#", ",", "2"}], "]"}]}], "]"}], "&"}], ",", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "400"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"50", ",", "2", ",", "2"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6219401269434223`*^9, 3.62194012715659*^9}, {
  3.621940203388076*^9, 3.621940203643043*^9}, {3.622189439938311*^9, 
  3.622189440409239*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", " ", "that", " ", "p"}], " ", "=", " ", 
     RowBox[{"1", " ", 
      RowBox[{"(", 
       RowBox[{"mod", " ", "3"}], ")"}]}]}], ",", " ", 
    RowBox[{"this", " ", "finds", " ", "the", " ", "tuple"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", ",", "n"}], ")"}], " ", "that", " ", "solves", " ", "the", 
     " ", "equation", " ", "algnorm", 
     RowBox[{"(", 
      RowBox[{"m", ",", "n"}], ")"}]}], " ", "=", " ", 
    RowBox[{"p", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FindTuple", "[", "p_Integer", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"p", "*", 
           RowBox[{"4", "/", "3"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{"True", ",", 
         RowBox[{
          RowBox[{"y", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "+", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3"}], "*", 
                 RowBox[{"x", "^", "2"}]}], "+", 
                RowBox[{"4", "*", "p"}]}], "]"}]}], ")"}], "/", "2"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Element", "[", 
             RowBox[{"y", ",", "Integers"}], "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3"}], "*", 
                 RowBox[{"x", "^", "2"}]}], "+", 
                RowBox[{"4", "*", "p"}]}], "]"}]}], ")"}], "/", "2"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Element", "[", 
             RowBox[{"y", ",", "Integers"}], "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x", "=", 
           RowBox[{"x", "-", "1"}]}], ";"}]}], "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.622189518543076*^9, 3.622189532216722*^9}, 
   3.622190512534134*^9, {3.622190545078285*^9, 3.62219057918298*^9}, {
   3.622190622962741*^9, 3.622190691682672*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "two", " ", "conditions", " ", "that", " ", "apply", " ", "to",
     " ", "our", " ", "visibility", " ", 
    RowBox[{"checks", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"p", " ", "=", " ", 
    RowBox[{"1", " ", 
     RowBox[{"(", 
      RowBox[{"mod", " ", "3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"first", " ", "condition"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"p", " ", "=", " ", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"mod", " ", "3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"second", " ", "condition"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pCond1", "[", "p_Integer", "]"}], ":=", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"p", "-", "1"}], ",", "3"}], "]"}], "\[Equal]", "0"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pCond2", "[", "p_Integer", "]"}], ":=", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"p", "-", "2"}], ",", "3"}], "]"}], "\[Equal]", "0"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6221894990178213`*^9, 3.62218951109803*^9}}],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"FindTuple", ",", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Prime", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], ",", "pCond1"}], 
    "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"algnormES", ",", "%"}], "]"}]], "Input",
 CellChangeTimes->{{3.622190754652505*^9, 3.6221907669513073`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"ConjES", ",", "MultES", ",", "SquareES", ",", "CubeES"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"IsDivCompES", ",", "divTest2Free1", ",", "divTest2Free2"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "visibility2Free", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.62192568243351*^9, 3.621925705659979*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Conjugate", " ", 
    RowBox[{"operation", ":", " ", 
     RowBox[{
      RowBox[{"a1", " ", "+", " ", 
       RowBox[{"b1", " ", "*", " ", 
        RowBox[{"omega", " ", "--"}]}]}], ">", " ", 
      RowBox[{"a1", " ", "-", " ", 
       RowBox[{"b1", " ", "*", " ", 
        RowBox[{"omega", "."}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"ConjES", "[", 
     RowBox[{"{", 
      RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"a1", ",", 
      RowBox[{"-", "b1"}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.621925659665564*^9, 3.621925668146804*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Multiplication", ",", " ", 
    RowBox[{
    "squaring", " ", "and", " ", "cubing", " ", "of", " ", "elements", " ", 
     "of", " ", "the", " ", "Eisenstein", " ", "Integers"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MultES", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], ":=", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a1", "*", "a2"}], "-", 
        RowBox[{"b1", "*", "b2"}]}], ",", 
       RowBox[{
        RowBox[{"a1", "*", "b2"}], "+", 
        RowBox[{"b1", "*", "a2"}], "-", 
        RowBox[{"b1", "*", "b2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"SquareES", "[", 
      RowBox[{"{", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "^", "2"}], "-", 
        RowBox[{"b", "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"2", "*", "a", "*", "b"}], "-", 
        RowBox[{"b", "^", "2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CubeES", "[", 
      RowBox[{"{", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "^", "3"}], "-", 
        RowBox[{"3", "*", "a", "*", 
         RowBox[{"b", "^", "2"}]}], "+", 
        RowBox[{"b", "^", "3"}]}], ",", 
       RowBox[{"3", "*", "a", "*", 
        RowBox[{"(", 
         RowBox[{"a", "-", "b"}], ")"}], "*", "b"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6219253286597147`*^9, 3.621925353000527*^9}, {
  3.621925393888064*^9, 3.621925489341291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "if", " ", "c", " ", "divides", " ", "both", " ", 
     "components", " ", "of", " ", "x"}], " ", "=", " ", 
    RowBox[{"a", " ", "+", " ", 
     RowBox[{"b", " ", "*", " ", "I"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IsDivCompES", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{"a", ",", "c"}], "]"}], "\[Equal]", "0"}], "&&", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{"b", ",", "c"}], "]"}], "\[Equal]", "0"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.621925701714328*^9, 3.621925701933134*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Division", " ", "test", " ", 
    RowBox[{"(", 
     RowBox[{"square", "-", 
      RowBox[{"free", " ", "case"}]}], ")"}], " ", "for", " ", "the", " ", 
    "primes", " ", "which", " ", "satisfy", " ", "the", " ", "first", " ", 
    RowBox[{"condition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"divTest2Free1", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "a1", ",", "a2", ",", "b1", ",", "b2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{"FindTuple", "[", "p", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"algnorm", 
          RowBox[{"(", "t", ")"}]}], " ", "=", " ", "p"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"a1", " ", "=", " ", 
        RowBox[{"SquareES", "[", "t", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"a1", " ", "=", " ", 
         RowBox[{"t", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"a2", " ", "=", " ", 
        RowBox[{"SquareES", "[", 
         RowBox[{"ConjES", "[", "t", "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"a2", " ", "=", " ", 
         RowBox[{"conj", 
          RowBox[{
           RowBox[{"(", "t", ")"}], "^", "2"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"b1", "=", 
        RowBox[{"MultES", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], ",", "a1"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"b1", " ", "=", " ", 
         RowBox[{"x", " ", "*", " ", "a1"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"b2", "=", 
        RowBox[{"MultES", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], ",", "a2"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"b2", " ", "=", " ", 
         RowBox[{"x", " ", "*", " ", "a2"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"IsDivCompES", "[", 
          RowBox[{"b1", ",", 
           RowBox[{"p", "^", "2"}]}], "]"}], "||", 
         RowBox[{"IsDivCompES", "[", 
          RowBox[{"b2", ",", 
           RowBox[{"p", "^", "2"}]}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.621938165526519*^9, 3.621938176863256*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Division", " ", "test", " ", 
    RowBox[{"(", 
     RowBox[{"square", "-", 
      RowBox[{"free", " ", "case"}]}], ")"}], " ", "for", " ", "the", " ", 
    "primes", " ", "which", " ", "satisfy", " ", "the", " ", "second", " ", 
    RowBox[{"condition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"divTest2Free2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
     "]"}], ":=", 
    RowBox[{"IsDivCompES", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], ",", 
      RowBox[{"p", "^", "2"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.621939250785818*^9, 3.6219392510096607`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "for", " ", "square"}], "-", 
    RowBox[{
     RowBox[{"free", " ", "'"}], 
     RowBox[{"visibility", "'"}], " ", "of", " ", "an", " ", "element", " ", 
     "of", " ", "the", " ", "Eisenstein", " ", 
     RowBox[{"integers", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"visibility2Free", "[", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"norm", ",", "primes", ",", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"m", "-", "n"}], ",", "3"}], "]"}], "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"m", ",", "3"}], "]"}], "\[Equal]", "0"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norm", "=", 
        RowBox[{"algnormES", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "norm", "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"primes", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
          RowBox[{"FactorInteger", "[", 
           RowBox[{"Abs", "[", "norm", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Catch", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"t", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"pCond1", "[", "t", "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"divTest2Free1", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                   RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"pCond2", "[", "t", "]"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"divTest2Free2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                    RowBox[{"Throw", "[", "False", "]"}]}], "]"}]}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "]"}], ",", "primes"}], "]"}],
            ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "===", "False"}], ",", 
         RowBox[{"Return", "[", "False", "]"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.621925734646187*^9, 3.6219257370799503`*^9}, {
  3.621938056933175*^9, 3.621938070276533*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"BasisES", ",", "DualES"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"vTable", ",", "vDraw"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.622191236892941*^9, 3.6221912619404488`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BasisES", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BasisES", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6219359978477488`*^9, 3.6219360077862062`*^9}, {
  3.621936044248599*^9, 3.62193605577176*^9}, {3.621936551703949*^9, 
  3.621936572838293*^9}, {3.6219386507578917`*^9, 3.621938651022928*^9}, {
  3.62219108595063*^9, 3.6221911148520317`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DualES", "=", 
   RowBox[{"BasisES", ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "BasisES", "]"}], ".", "BasisES"}], "]"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"DualES", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.621936589172789*^9, 3.621936638645987*^9}, {
  3.621938656164501*^9, 3.621938656349596*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Generate", " ", "a", " ", "list", " ", "of", " ", "elements", " ", 
    RowBox[{"(", 
     RowBox[{"which", " ", "later", " ", "become", " ", "vertices"}], ")"}], 
    " ", "of", " ", "the", " ", "Eisenstein", " ", 
    RowBox[{"integers", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vTable", "[", "r_Integer", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"-", "r"}], ",", "r"}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
    ";"}]}]], "Input",
 CellChangeTimes->{{3.6221908477331657`*^9, 3.622190850340399*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vDraw", "[", 
    RowBox[{"in_", ",", 
     RowBox[{"axes_:", "True"}], ",", 
     RowBox[{"pstyle_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BasisES", ".", "#"}], "&"}], ",", "in"}], "]"}], ",", 
     RowBox[{"Axes", "\[Rule]", "axes"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "pstyle"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.62219091300189*^9, 3.622190954471796*^9, {3.6221911437062273`*^9, 
   3.622191149383917*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"vDraw", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"vTable", "[", "60", "]"}], ",", "visibility2Free"}], "]"}], 
     ",", "False"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1.0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6221910191970367`*^9, 3.6221910265445004`*^9}, {
  3.622191178425578*^9, 3.622191214138685*^9}}]
},
WindowSize->{1920, 1145},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 391, 10, 64, "Input"],
Cell[951, 32, 606, 16, 64, "Input"],
Cell[1560, 50, 2429, 65, 239, "Input"],
Cell[3992, 117, 2168, 52, 339, "Input"],
Cell[6163, 171, 182, 6, 38, "Input"],
Cell[6348, 179, 634, 18, 38, "Input"],
Cell[6985, 199, 2894, 80, 239, "Input"],
Cell[9882, 281, 1317, 40, 139, "Input"],
Cell[11202, 323, 324, 10, 38, "Input"],
Cell[11529, 335, 155, 3, 38, "Input"],
Cell[11687, 340, 460, 11, 89, "Input"],
Cell[12150, 353, 717, 21, 64, "Input"],
Cell[12870, 376, 1908, 58, 114, "Input"],
Cell[14781, 436, 810, 25, 64, "Input"],
Cell[15594, 463, 2656, 70, 239, "Input"],
Cell[18253, 535, 786, 21, 64, "Input"],
Cell[19042, 558, 3565, 90, 314, "Input"],
Cell[22610, 650, 297, 7, 64, "Input"],
Cell[22910, 659, 704, 18, 89, "Input"],
Cell[23617, 679, 401, 10, 64, "Input"],
Cell[24021, 691, 902, 24, 64, "Input"],
Cell[24926, 717, 594, 17, 38, "Input"],
Cell[25523, 736, 640, 17, 64, "Input"]
}
]
*)

(* End of internal cache information *)
