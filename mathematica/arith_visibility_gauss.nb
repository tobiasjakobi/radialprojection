(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     40944,       1161]
NotebookOptionsPosition[     39323,       1113]
NotebookOutlinePosition[     39680,       1129]
CellTagsIndexPosition[     39637,       1126]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "comments", " ", "see", " ", 
   RowBox[{"the", " ", "'"}], 
   RowBox[{"arith_visibility", "'"}], " ", 
   RowBox[{"notebook", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.622195765370426*^9, 3.622195786321032*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "This", " ", "notebook", " ", "needs", " ", "the", " ", "aforementioned", 
    " ", 
    RowBox[{"one", ".", " ", "GI"}]}], " ", "==", " ", 
   RowBox[{"Gaussian", " ", 
    RowBox[{"Integers", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.622197726488361*^9, 3.622197732903687*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"algnormGI", ",", "ModuloGI", ",", "GCDGI"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"FindTupleGI", ",", "pCond1GI", ",", "pCond2GI"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.621851028089699*^9, 3.6218510578684998`*^9}, {
  3.6221961193971*^9, 3.622196124710518*^9}, {3.6221964702189217`*^9, 
  3.622196504471964*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"algnormGI", "[", 
    RowBox[{"{", 
     RowBox[{"a_Integer", ",", " ", "b_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "^", "2"}], "+", 
    RowBox[{"b", "^", "2"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.621849907616482*^9, 3.621849932373185*^9}, {
   3.621851085351417*^9, 3.621851095032254*^9}, 3.62219578983983*^9, {
   3.622196508024268*^9, 3.62219650867986*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ModuloGI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], " ", ":=",
    "\n", "  ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"norm", ",", "alpha", ",", " ", "beta"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"norm", " ", "=", " ", 
       RowBox[{"algnormGI", "[", 
        RowBox[{"{", 
         RowBox[{"a2", ",", "b2"}], "}"}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"alpha", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a1", "*", "a2"}], " ", "+", 
           RowBox[{"b1", "*", "b2"}]}], ")"}], "/", "norm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"beta", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a1"}], "*", "b2"}], "+", 
           RowBox[{"b1", "*", "a2"}]}], ")"}], "/", "norm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"alpha", "*", "a2"}], "-", 
            RowBox[{"beta", "*", "b2"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"b1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"alpha", "*", "b2"}], "+", 
            RowBox[{"beta", "*", "a2"}]}], ")"}]}]}], "}"}], "]"}], ";"}]}], 
    "\n", "  ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.621846634461241*^9, 3.621846743990818*^9}, {
   3.621846819716527*^9, 3.621846851314755*^9}, {3.621849243596232*^9, 
   3.621849331666802*^9}, {3.6218497067222147`*^9, 3.621849726323064*^9}, {
   3.621849826032316*^9, 3.621849846652979*^9}, {3.621849935659693*^9, 
   3.621849946877633*^9}, {3.6218500789479027`*^9, 3.621850108243919*^9}, {
   3.6218510692643127`*^9, 3.621851082829776*^9}, 3.62219579152459*^9, {
   3.622196510893011*^9, 3.622196519354368*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GCDGI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], " ", ":=",
    "\n", "  ", 
   RowBox[{"Block", "[", "\n", "     ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}], ",", "\n", "     ", 
     
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"a1", ",", " ", "b1"}], "}"}]}], ";", "\n", "     ", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"a2", ",", " ", "b2"}], "}"}]}], ";", "\n", "     ", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"y", " ", "!=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}]}], ",", "\n", "       ", 
        RowBox[{
         RowBox[{"z", " ", "=", " ", "y"}], ";", "\n", "       ", 
         RowBox[{"y", " ", "=", " ", 
          RowBox[{"ModuloGI", "[", 
           RowBox[{"x", ",", " ", "y"}], "]"}]}], ";", "\n", "       ", 
         RowBox[{"x", " ", "=", " ", "z"}], ";"}]}], "\n", "     ", "]"}], 
      ";", "\n", "     ", 
      RowBox[{"Return", "[", "x", "]"}]}]}], "\n", "  ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.621849878087224*^9, 3.621849888998722*^9}, {
   3.6218501184004374`*^9, 3.621850130387189*^9}, {3.621850244078668*^9, 
   3.621850244666687*^9}, 3.6221957930262947`*^9, {3.622196523129526*^9, 
   3.6221965236110573`*^9}, {3.6221991817649307`*^9, 3.62219918230746*^9}}],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"GCDGI", "[", 
     RowBox[{
      RowBox[{"Part", "[", 
       RowBox[{"#", ",", "1"}], "]"}], ",", 
      RowBox[{"Part", "[", 
       RowBox[{"#", ",", "2"}], "]"}]}], "]"}], "&"}], ",", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "400"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"50", ",", "2", ",", "2"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.621850224474504*^9, {3.6218502827301607`*^9, 3.621850423061967*^9}, {
   3.621850542531633*^9, 3.621850542737665*^9}, {3.6221977457699423`*^9, 
   3.622197748187894*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindTupleGI", "[", "p_Integer", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Sqrt", "[", "p", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"While", "[", 
       RowBox[{"True", ",", 
        RowBox[{
         RowBox[{"y", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"p", "-", 
            RowBox[{"x", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"y", ",", "Integers"}], "]"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"x", "-", "1"}]}], ";"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6218509831749687`*^9, 3.621851007072789*^9}, {
   3.6218513669959307`*^9, 3.621851368818164*^9}, {3.6218514605418243`*^9, 
   3.621851485294241*^9}, {3.621851586570861*^9, 3.621851586694186*^9}, {
   3.621851617257855*^9, 3.621851619083542*^9}, {3.621851785491109*^9, 
   3.621851819425419*^9}, 3.6221958052085333`*^9, {3.622196114234858*^9, 
   3.6221961143785543`*^9}, {3.6221965773206987`*^9, 3.6221965778482513`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pCond1GI", "[", "p_Integer", "]"}], ":=", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"p", "-", "1"}], ",", "4"}], "]"}], "\[Equal]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pCond2GI", "[", "p_Integer", "]"}], ":=", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"p", "-", "3"}], ",", "4"}], "]"}], "\[Equal]", "0"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6218506058840218`*^9, 3.621850643610375*^9}, {
   3.621850990786674*^9, 3.621850991645544*^9}, 3.622195815094245*^9, {
   3.622196133336273*^9, 3.6221961364055862`*^9}, {3.622196583046578*^9, 
   3.622196586836191*^9}}],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"FindTupleGI", ",", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Prime", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], ",", 
     "pCond1GI"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.622196139556778*^9, 3.622196139748631*^9}, {
  3.622196589525405*^9, 3.622196590405117*^9}, {3.6221977561702757`*^9, 
  3.6221977563595247`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"ConjGI", ",", "MultGI", ",", "SquareGI", ",", "CubeGI"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"divTest2Free1GI", ",", "divTest2Free2GI"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "visibility2FreeGI", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.621850683443125*^9, 3.621850688338571*^9}, {
  3.622196145527467*^9, 3.622196145670826*^9}, {3.622196176019903*^9, 
  3.622196185029413*^9}, {3.622196592742592*^9, 3.622196627121684*^9}, {
  3.6221977622135687`*^9, 3.62219776251766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConjGI", "[", 
    RowBox[{"{", 
     RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"a1", ",", 
     RowBox[{"-", "b1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.621850672184355*^9, 3.621850681109824*^9}, {
  3.622195823029934*^9, 3.622195855983103*^9}, {3.622196630131275*^9, 
  3.6221966305472183`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MultGI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a1", "*", "a2"}], "-", 
      RowBox[{"b1", "*", "b2"}]}], ",", 
     RowBox[{
      RowBox[{"a1", "*", "b2"}], "+", 
      RowBox[{"b1", "*", "a2"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SquareGI", "[", 
    RowBox[{"{", 
     RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "^", "2"}], "-", 
      RowBox[{"b", "^", "2"}]}], ",", 
     RowBox[{"2", "*", "a", "*", "b"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CubeGI", "[", 
    RowBox[{"{", 
     RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "^", "3"}], "-", 
      RowBox[{"3", "*", "a", "*", 
       RowBox[{"b", "^", "2"}]}]}], ",", 
     RowBox[{
      RowBox[{"3", "*", 
       RowBox[{"a", "^", "2"}], "*", "b"}], "-", 
      RowBox[{"b", "^", "3"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.62185070279126*^9, 3.621850722700307*^9}, {
   3.6218508356686697`*^9, 3.6218509208681793`*^9}, 3.622195824579897*^9, {
   3.6221966322953053`*^9, 3.6221966374950447`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"divTest2Free1GI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "a1", ",", "a2", ",", "b1", ",", "b2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"FindTupleGI", "[", "p", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"algnorm", 
         RowBox[{"(", "t", ")"}]}], " ", "=", " ", "p"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"a1", " ", "=", " ", 
       RowBox[{"SquareGI", "[", "t", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"a1", " ", "=", " ", 
        RowBox[{"t", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"a2", " ", "=", " ", 
       RowBox[{"SquareGI", "[", 
        RowBox[{"ConjGI", "[", "t", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"a2", " ", "=", " ", 
        RowBox[{"conj", 
         RowBox[{
          RowBox[{"(", "t", ")"}], "^", "2"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"b1", "=", 
       RowBox[{"MultGI", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], ",", "a1"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"b1", " ", "=", " ", 
        RowBox[{"x", " ", "*", " ", "a1"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"b2", "=", 
       RowBox[{"MultGI", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], ",", "a2"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"b2", " ", "=", " ", 
        RowBox[{"x", " ", "*", " ", "a2"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"IsDivComp", "[", 
         RowBox[{"b1", ",", 
          RowBox[{"p", "^", "2"}]}], "]"}], "||", 
        RowBox[{"IsDivComp", "[", 
         RowBox[{"b2", ",", 
          RowBox[{"p", "^", "2"}]}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.621850753404714*^9, 3.621850761781824*^9}, {
  3.621851904929268*^9, 3.621851905855492*^9}, {3.6221958826239634`*^9, 
  3.622195884253359*^9}, {3.622196196603424*^9, 3.622196204186791*^9}, {
  3.622196643081503*^9, 3.622196658673358*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"divTest2Free2GI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
    "]"}], ":=", 
   RowBox[{"IsDivComp", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}], ",", 
     RowBox[{"p", "^", "2"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.621850772370933*^9, {3.622195892002825*^9, 3.6221958921461906`*^9}, {
   3.622196214285431*^9, 3.622196216099801*^9}, {3.622196660684474*^9, 
   3.622196662338727*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"visibility2FreeGI", "[", 
    RowBox[{"{", 
     RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"norm", ",", "primes", ",", "c"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"m", "-", "n"}], ",", "2"}], "]"}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"m", ",", "2"}], "]"}], "\[Equal]", "0"}]}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"algnormGI", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "norm", "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"primes", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
         RowBox[{"FactorInteger", "[", 
          RowBox[{"Abs", "[", "norm", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Catch", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"t", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pCond1GI", "[", "t", "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"divTest2Free1GI", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                  RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pCond2GI", "[", "t", "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"divTest2Free2GI", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                    RowBox[{"Throw", "[", "False", "]"}]}], "]"}]}], "]"}]}], 
               "]"}]}], "\[IndentingNewLine]", "]"}], ",", "primes"}], "]"}], 
          ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"c", "===", "False"}], ",", 
        RowBox[{"Return", "[", "False", "]"}], ",", 
        RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6218505506357*^9, 3.62185056754604*^9}, {
   3.62192574088911*^9, 3.621925744616096*^9}, 3.621935220197755*^9, {
   3.622196231003394*^9, 3.622196238299098*^9}, {3.622196664634666*^9, 
   3.622196682315928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vTableGI", "[", "r_Integer", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"-", "r"}], ",", "r"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.621851941530418*^9, 3.6218519546138773`*^9}, 
   3.6221959350534687`*^9, {3.622199382842128*^9, 3.6221993830500927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vDrawGI", "[", 
    RowBox[{"in_", ",", 
     RowBox[{"axes_:", "True"}], ",", 
     RowBox[{"pstyle_:", "Automatic"}]}], "]"}], ":=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"in", ",", 
     RowBox[{"Axes", "\[Rule]", "axes"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "pstyle"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.621851987104624*^9, 3.6218519882418737`*^9}, {
  3.6221993864567738`*^9, 3.6221993866159782`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"vDrawGI", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"vTableGI", "[", "40", "]"}], ",", "visibility2FreeGI"}], 
      "]"}], ",", "False"}], "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1.0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.621852005361972*^9, 3.621852045540306*^9}, {
  3.621852077969544*^9, 3.621852089939618*^9}, {3.622197707706956*^9, 
  3.622197707864883*^9}, {3.62219939509583*^9, 3.6221993983294764`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Function", "[", 
   RowBox[{"x", ",", 
    RowBox[{"ArrayPlot", "[", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", "1"}], ",", 
              RowBox[{"x", "+", "1"}]}], "}"}]}], "&"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"vTableGI", "[", "x", "]"}], ",", "visibility2FreeGI"}], 
           "]"}]}], "]"}]}], "]"}], "]"}], "]"}]}], "]"}], "[", "50", 
  "]"}]], "Input",
 CellChangeTimes->{{3.62185273670333*^9, 3.621852769863789*^9}, {
  3.621852903251232*^9, 3.621852943121155*^9}, {3.62185309956343*^9, 
  3.621853174059163*^9}, {3.621853216765573*^9, 3.621853283439445*^9}, {
  3.621853352486334*^9, 3.621853358854521*^9}, {3.621853631017914*^9, 
  3.621853645302112*^9}, {3.621935282413546*^9, 3.621935282653411*^9}, {
  3.622197713403467*^9, 3.622197713691205*^9}, {3.6221994094982777`*^9, 
  3.622199409641728*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Function", "[", 
   RowBox[{"x", ",", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"vTableGI", "[", "x", "]"}], ",", "visibility2FreeGI"}], 
        "]"}], "]"}], "/", 
      RowBox[{"Length", "[", 
       RowBox[{"vTableGI", "[", "x", "]"}], "]"}]}], "]"}]}], "]"}], "[", 
  "180", "]"}]], "Input",
 CellChangeTimes->{
  3.622195938707384*^9, {3.622197710921467*^9, 3.62219771114596*^9}, {
   3.6221994145685368`*^9, 3.6221994166334047`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "DivGI", ",", "IsDivGI", ",", "denomGI", ",", "pTest1GI", ",", 
    "factorGI"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.622191960793396*^9, 3.622191962981522*^9}, {
  3.622197493602605*^9, 3.622197507968013*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DivGI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"algnormGI", "[", 
        RowBox[{"{", 
         RowBox[{"a2", ",", "b2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"a1", "*", "a2"}], "+", 
        RowBox[{"b1", "*", "b2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a1"}], "*", "b2"}], "+", 
        RowBox[{"b1", "*", "a2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Divide", "[", 
         RowBox[{"x", ",", "n"}], "]"}], ",", 
        RowBox[{"Divide", "[", 
         RowBox[{"y", ",", "n"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6221919689835873`*^9, 3.622192019735239*^9}, {
   3.622194903580228*^9, 3.6221949203948307`*^9}, 3.622195945244149*^9, {
   3.622196689715645*^9, 3.6221966901802683`*^9}, {3.6221977932278137`*^9, 
   3.6221977934493933`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IsDivGI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"algnormGI", "[", 
        RowBox[{"{", 
         RowBox[{"a2", ",", "b2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"a1", "*", "a2"}], "+", 
        RowBox[{"b1", "*", "b2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a1"}], "*", "b2"}], "+", 
        RowBox[{"b1", "*", "a2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"x", ",", "n"}], "]"}], "\[Equal]", "0"}], "&&", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"y", ",", "n"}], "]"}], "\[Equal]", "0"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.622192024560713*^9, 3.62219203771871*^9}, {
   3.6221949251640263`*^9, 3.622194928027424*^9}, 3.62219594733081*^9, {
   3.6221966940842457`*^9, 3.622196695028314*^9}, {3.622197795577219*^9, 
   3.622197796025687*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"denomGI", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
     "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "g"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"4", "*", "b"}], ",", 
          RowBox[{"2", "*", "a"}]}], "}"}]}], ";"}], "*)"}], 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{"add", " ", "comment"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"GCDGI", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "0"}], "}"}], ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"DivGI", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "0"}], "}"}], ",", "g"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.622192122101014*^9, 3.6221921232210617`*^9}, {
  3.622194945625072*^9, 3.622194990823577*^9}, {3.622195952642728*^9, 
  3.6221959602573013`*^9}, {3.622196697764381*^9, 3.622196698020507*^9}, {
  3.622197800505754*^9, 3.62219780679272*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pTest1GI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"FindTupleGI", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"ConjGI", "[", "t", "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"IsDivGI", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}], ",", "#"}], "]"}], "&"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.62219206210783*^9, 3.622192065944419*^9}, {
  3.622196700515059*^9, 3.622196700722513*^9}, {3.6221978094630957`*^9, 
  3.622197814759383*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"factorGI", "[", 
    RowBox[{"{", 
     RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"norm", ",", "nprimes"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"norm", "=", 
       RowBox[{"algnormGI", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "norm", "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nprimes", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
         RowBox[{"FactorInteger", "[", 
          RowBox[{"Abs", "[", "norm", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"x", ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"x", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], "}"}], ",", 
              RowBox[{"(*", 
               RowBox[{"TODO", ":", " ", 
                RowBox[{"check", " ", "this"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pCond2GI", "[", "x", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0"}], "}"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pCond1GI", "[", "x", "]"}], ",", 
                  RowBox[{"pTest1GI", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "x"}], "]"}]}], 
                 "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",",
           "nprimes"}], "]"}], ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.622192102067137*^9, 3.622192111011991*^9}, {
  3.6221949712267447`*^9, 3.6221949730195704`*^9}, {3.622195969748498*^9, 
  3.622195983986537*^9}, {3.6221967103428164`*^9, 3.622196713014709*^9}, {
  3.62219781802713*^9, 3.622197821819385*^9}, {3.622199446765256*^9, 
  3.622199451804686*^9}}],

Cell[BoxData[
 RowBox[{"factorGI", "[", 
  RowBox[{"{", 
   RowBox[{"13", ",", "7"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.622195987590479*^9, 3.622195991002512*^9}, {
  3.622196715073001*^9, 3.622196715985014*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"intensityGI", ",", "vqTableRecipGI"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.622195626711186*^9, 3.62219563518272*^9}, {
  3.622196723662608*^9, 3.622196723806644*^9}, {3.6221978272517843`*^9, 
  3.6221978274115343`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intensityGI", "[", 
    RowBox[{"{", 
     RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "prod"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"m", "\[Equal]", "0"}], "&&", 
         RowBox[{"n", "\[Equal]", "0"}]}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", 
          RowBox[{"Sqrt", "[", "2", "]"}], "*", "1.0"}], ")"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{"use", " ", "correct", " ", "zeta"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"prod", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"algnormGI", "[", "#", "]"}], "^", "2"}], "-", "1"}], 
              ")"}]}], "&"}], ",", 
           RowBox[{"factorGI", "[", 
            RowBox[{"{", 
             RowBox[{"m", ",", "n"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"f", "*", "prod"}], ")"}], "^", "2"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.622195045620511*^9, 3.622195073096339*^9}, 
   3.622195758379284*^9, {3.622195998882049*^9, 3.6221960006417303`*^9}, {
   3.6221978364252977`*^9, 3.6221978414481277`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vqTableRecipGI", "[", 
    RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", "c"}], "}"}], "/", 
         RowBox[{"GCD", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "1", ",", "s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", 
          RowBox[{"-", "r"}], ",", "r"}], "}"}]}], "]"}], ",", "2"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.622195100126404*^9, 3.622195107334599*^9}, {
  3.622197834324744*^9, 3.622197834468567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "divTest3Free1GI", ",", "divTest3Free2GI", ",", "visiblity3FreeGI"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.622197850784931*^9, 3.6221978547223463`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"divTest3Free1GI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "a1", ",", "a2", ",", "b1", ",", "b2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"FindTupleGI", "[", "p", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"algnorm", 
         RowBox[{"(", "t", ")"}]}], " ", "=", " ", "p"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"a1", "=", 
       RowBox[{"CubeGI", "[", "t", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"a1", " ", "=", " ", 
        RowBox[{"t", "^", "3"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"a2", "=", 
       RowBox[{"CubeGI", "[", 
        RowBox[{"ConjGI", "[", "t", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"a2", " ", "=", " ", 
        RowBox[{"conj", 
         RowBox[{
          RowBox[{"(", "t", ")"}], "^", "3"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"b1", "=", 
       RowBox[{"MultGI", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], ",", "a1"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"b1", " ", "=", " ", 
        RowBox[{"x", " ", "*", " ", "a1"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"b2", "=", 
       RowBox[{"MultGI", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], ",", "a2"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"b2", " ", "=", " ", 
        RowBox[{"x", " ", "*", " ", "a2"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"IsDivComp", "[", 
         RowBox[{"b1", ",", 
          RowBox[{"p", "^", "3"}]}], "]"}], "||", 
        RowBox[{"IsDivComp", "[", 
         RowBox[{"b2", ",", 
          RowBox[{"p", "^", "3"}]}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6221956578731203`*^9, 3.6221956721435337`*^9}, {
  3.622197844506893*^9, 3.622197872248495*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"divTest3Free2GI", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
    "]"}], ":=", 
   RowBox[{"IsDivComp", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}], ",", 
     RowBox[{"p", "^", "3"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.622195656201169*^9, 3.622195693608488*^9, {3.622197873778767*^9, 
   3.622197875969502*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"visiblity3FreeGI", "[", 
    RowBox[{"{", 
     RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"norm", ",", "primes", ",", "c"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"IsDivGI", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      RowBox[{"(*", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{"check", " ", "this"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"algnormGI", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "norm", "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"primes", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
         RowBox[{"FactorInteger", "[", 
          RowBox[{"Abs", "[", "norm", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Catch", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"t", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pCond1GI", "[", "t", "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"divTest3Free1GI", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                  RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pCond2GI", "[", "t", "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"divTest3Free2GI", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                    RowBox[{"Throw", "[", "False", "]"}]}], "]"}]}], "]"}]}], 
               "]"}]}], "\[IndentingNewLine]", "]"}], ",", "primes"}], "]"}], 
          ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"c", "===", "False"}], ",", 
        RowBox[{"Return", "[", "False", "]"}], ",", 
        RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6221957146884413`*^9, 3.62219574918323*^9}, {
   3.622197877689571*^9, 3.622197889883642*^9}, 3.6221994630858603`*^9}]
},
WindowSize->{1920, 1145},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 282, 6, 38, "Input"],
Cell[842, 28, 354, 9, 38, "Input"],
Cell[1199, 39, 444, 11, 64, "Input"],
Cell[1646, 52, 437, 11, 38, "Input"],
Cell[2086, 65, 2237, 59, 214, "Input"],
Cell[4326, 126, 1594, 39, 314, "Input"],
Cell[5923, 167, 664, 19, 38, "Input"],
Cell[6590, 188, 1476, 36, 139, "Input"],
Cell[8069, 226, 707, 20, 64, "Input"],
Cell[8779, 248, 497, 13, 38, "Input"],
Cell[9279, 263, 641, 14, 89, "Input"],
Cell[9923, 279, 414, 11, 38, "Input"],
Cell[10340, 292, 1493, 46, 89, "Input"],
Cell[11836, 340, 2444, 65, 214, "Input"],
Cell[14283, 407, 552, 16, 38, "Input"],
Cell[14838, 425, 3279, 84, 289, "Input"],
Cell[18120, 511, 632, 18, 38, "Input"],
Cell[18755, 531, 481, 12, 38, "Input"],
Cell[19239, 545, 524, 12, 38, "Input"],
Cell[19766, 559, 1177, 29, 38, "Input"],
Cell[20946, 590, 566, 16, 38, "Input"],
Cell[21515, 608, 287, 7, 38, "Input"],
Cell[21805, 617, 1406, 38, 164, "Input"],
Cell[23214, 657, 1437, 39, 164, "Input"],
Cell[24654, 698, 1475, 42, 139, "Input"],
Cell[26132, 742, 959, 27, 114, "Input"],
Cell[27094, 771, 2760, 70, 264, "Input"],
Cell[29857, 843, 224, 5, 38, "Input"],
Cell[30084, 850, 293, 6, 38, "Input"],
Cell[30380, 858, 1799, 50, 164, "Input"],
Cell[32182, 910, 936, 27, 38, "Input"],
Cell[33121, 939, 232, 6, 38, "Input"],
Cell[33356, 947, 2278, 63, 214, "Input"],
Cell[35637, 1012, 476, 15, 38, "Input"],
Cell[36116, 1029, 3203, 82, 289, "Input"]
}
]
*)

(* End of internal cache information *)
