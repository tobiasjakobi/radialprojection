(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     98572,       2585]
NotebookOptionsPosition[     95335,       2498]
NotebookOutlinePosition[     95692,       2514]
CellTagsIndexPosition[     95649,       2511]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "algnormZ2", ",", "FindTupleZ2", ",", "pCond1Z2", ",", "pCond2Z2"}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.620986845098621*^9, 3.620986863370273*^9}, 
   3.6221963193112917`*^9, {3.622196373516782*^9, 3.622196378556245*^9}, {
   3.622197162114463*^9, 3.622197171772731*^9}, {3.622198345425602*^9, 
   3.622198357980689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "$Path", ",", 
    "\"\</homes/tjakobi/PhD_Work/radialprojection/mathematica/packages\>\""}],
    "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"<<", "EuclideanAlgorithmZSqrt2`"}]], "Input",
 CellChangeTimes->{{3.619869620909375*^9, 3.6198696291597233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Computes", " ", "the", " ", "algebraic", " ", "norm", " ", "of", " ", 
     "x"}], " ", "=", " ", 
    RowBox[{"m", " ", "+", " ", 
     RowBox[{"n", " ", "*", " ", 
      RowBox[{"Sqrt", "[", "2", "]"}], " ", "in", " ", 
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{"Sqrt", "[", "2", "]"}], "]"}], "."}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"algnormZ2", "[", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"m", "^", "2"}], "-", 
     RowBox[{"2", "*", 
      RowBox[{"n", "^", "2"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6221972354090023`*^9, 3.6221972416496077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Assuming", " ", "that", " ", "p"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"+", "1"}], " ", "or"}], " ", "-", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"mod", " ", "8"}], ")"}]}]}]}], ",", " ", 
    RowBox[{"this", " ", "finds", " ", "the", " ", "tuple"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", ",", "n"}], ")"}], " ", "that", " ", "solves", " ", "the", 
     " ", "equation", " ", "algnorm", 
     RowBox[{"(", 
      RowBox[{"m", ",", "n"}], ")"}]}], " ", "=", " ", 
    RowBox[{"p", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FindTupleZ2", "[", "p_Integer", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"Sqrt", "[", "p", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{"True", ",", 
         RowBox[{
          RowBox[{"y", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "^", "2"}], "-", "p"}], ")"}], "/", "2"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Element", "[", 
             RowBox[{"y", ",", "Integers"}], "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x", "=", 
           RowBox[{"x", "+", "1"}]}], ";"}]}], "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.619779675316455*^9, 3.619779879868436*^9}, {
   3.6197799120358343`*^9, 3.619779972392207*^9}, {3.619780014679854*^9, 
   3.6197801097965393`*^9}, {3.619780857734366*^9, 3.619780881143944*^9}, {
   3.6197810668348417`*^9, 3.619781069249818*^9}, 3.619781417557673*^9, 
   3.619781465852149*^9, {3.619852099838594*^9, 3.61985217151079*^9}, {
   3.620973686405985*^9, 3.620973687715667*^9}, {3.620992101682494*^9, 
   3.620992102275835*^9}, {3.622196310213271*^9, 3.6221963104985313`*^9}, {
   3.622197222432084*^9, 3.6221972296778297`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "two", " ", "conditions", " ", "that", " ", "apply", " ", "to",
     " ", "our", " ", "visibility", " ", 
    RowBox[{"checks", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"p", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"+", "1"}], " ", "or"}], " ", "-", 
     RowBox[{"1", " ", 
      RowBox[{"(", 
       RowBox[{"mod", " ", "8"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"first", " ", "condition"}], ")"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"p", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"+", "3"}], " ", "or"}], " ", "-", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"mod", " ", "8"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"second", " ", "condition"}], ")"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pCond1Z2", "[", "p_Integer", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"p", "-", "1"}], ",", "8"}], "]"}], "\[Equal]", "0"}], "||", 
      
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"p", "+", "1"}], ",", "8"}], "]"}], "\[Equal]", "0"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pCond2Z2", "[", "p_Integer", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"p", "-", "3"}], ",", "8"}], "]"}], "\[Equal]", "0"}], "||", 
      
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"p", "+", "3"}], ",", "8"}], "]"}], "\[Equal]", "0"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.619780179684876*^9, 3.619780256309824*^9}, {
  3.619780480115715*^9, 3.6197805033641853`*^9}, {3.619852214481332*^9, 
  3.619852282865961*^9}, {3.6198575443409357`*^9, 3.6198575444448223`*^9}, {
  3.620973725922144*^9, 3.620973731504304*^9}, {3.622196380625965*^9, 
  3.622196382097618*^9}, {3.622196740857581*^9, 3.622196747889553*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "application", " ", "of", " ", "first", " ", "condition", 
    " ", "to", " ", "some", " ", 
    RowBox[{"primes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Prime", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "50"}], "}"}]}], "]"}], ",", "pCond1Z2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.619780266581923*^9, 3.619780282583509*^9}, {
  3.619780599694001*^9, 3.619780600141452*^9}, {3.6198570684836187`*^9, 
  3.6198570789518547`*^9}, {3.622196386859363*^9, 3.622196389150288*^9}, {
  3.622197193721766*^9, 3.62219720063303*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "tuple", " ", "computation", " ", "for", " ", "some", " ", 
    RowBox[{"primes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{"FindTupleZ2", ",", "%"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6197802904180717`*^9, 3.6197802953847933`*^9}, {
  3.619857083733816*^9, 3.6198570995409517`*^9}, {3.622196391500746*^9, 
  3.622196391836368*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"ConjZ2", ",", "MultZ2", ",", "SquareZ2", ",", "CubeZ2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"IsDivComp", ",", "divTest2Free1Z2", ",", "divTest2Free2Z2"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "visibility2FreeZ2", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6209868762538424`*^9, 3.620986911558775*^9}, 
   3.621598811372768*^9, {3.6221963962049837`*^9, 3.622196398148416*^9}, {
   3.6221967860623207`*^9, 3.622196789421382*^9}, {3.622197261787565*^9, 
   3.622197261947153*^9}, {3.622198374062026*^9, 3.622198375594862*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Conjugate", " ", 
    RowBox[{"operation", ":", " ", 
     RowBox[{
      RowBox[{"a1", " ", "+", " ", 
       RowBox[{"b1", " ", "*", " ", 
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], " ", "--"}]}]}], ">", " ", 
      RowBox[{"a1", " ", "-", " ", 
       RowBox[{"b1", " ", "*", " ", 
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], "."}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ConjZ2", "[", 
     RowBox[{"{", 
      RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"a1", ",", 
      RowBox[{"-", "b1"}]}], "}"}]}], ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Multiplication", ",", " ", 
    RowBox[{
    "squaring", " ", "and", " ", "cubing", " ", "of", " ", "elements", " ", 
     "of", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"Sqrt", "[", "2", "]"}], "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MultZ2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], ":=", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a1", "*", "a2"}], "+", 
        RowBox[{"2", "*", "b1", "*", "b2"}]}], ",", 
       RowBox[{
        RowBox[{"a1", "*", "b2"}], "+", 
        RowBox[{"a2", "*", "b1"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"SquareZ2", "[", 
      RowBox[{"{", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "^", "2"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{"b", "^", "2"}]}]}], ",", 
       RowBox[{"2", "*", "a", "*", "b"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CubeZ2", "[", 
      RowBox[{"{", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "^", "3"}], "+", 
        RowBox[{"6", "*", "a", "*", 
         RowBox[{"b", "^", "2"}]}]}], ",", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"a", "^", "2"}], "*", "b"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{"b", "^", "3"}]}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.620986479714913*^9, 3.62098650454784*^9}, {
  3.6209867296959963`*^9, 3.620986732612866*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "if", " ", "c", " ", "divides", " ", "both", " ", 
     "components", " ", "of", " ", "x"}], " ", "=", " ", 
    RowBox[{"a", " ", "+", " ", 
     RowBox[{"b", " ", "*", " ", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IsDivComp", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{"a", ",", "c"}], "]"}], "\[Equal]", "0"}], "&&", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{"b", ",", "c"}], "]"}], "\[Equal]", "0"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.622196765488769*^9, 3.622196765632247*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Division", " ", "test", " ", 
    RowBox[{"(", 
     RowBox[{"square", "-", 
      RowBox[{"free", " ", "case"}]}], ")"}], " ", "for", " ", "the", " ", 
    "primes", " ", "which", " ", "satisfy", " ", "the", " ", "first", " ", 
    RowBox[{"condition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"divTest2Free1Z2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "a1", ",", "a2", ",", "b1", ",", "b2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{"FindTupleZ2", "[", "p", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"algnorm", 
          RowBox[{"(", "t", ")"}]}], " ", "=", " ", "p"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"a1", " ", "=", " ", 
        RowBox[{"SquareZ2", "[", "t", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"a1", " ", "=", " ", 
         RowBox[{"t", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"a2", " ", "=", " ", 
        RowBox[{"SquareZ2", "[", 
         RowBox[{"ConjZ2", "[", "t", "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"a2", " ", "=", " ", 
         RowBox[{"conj", 
          RowBox[{
           RowBox[{"(", "t", ")"}], "^", "2"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"b1", "=", 
        RowBox[{"MultZ2", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], ",", "a1"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"b1", " ", "=", " ", 
         RowBox[{"x", " ", "*", " ", "a1"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"b2", "=", 
        RowBox[{"MultZ2", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], ",", "a2"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"b2", " ", "=", " ", 
         RowBox[{"x", " ", "*", " ", "a2"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"IsDivComp", "[", 
          RowBox[{"b1", ",", 
           RowBox[{"p", "^", "2"}]}], "]"}], "||", 
         RowBox[{"IsDivComp", "[", 
          RowBox[{"b2", ",", 
           RowBox[{"p", "^", "2"}]}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6197824916704407`*^9, 3.61978252376023*^9}, {
   3.6197836008062267`*^9, 3.6197836234788227`*^9}, {3.619783696650107*^9, 
   3.61978370486703*^9}, {3.619783748338551*^9, 3.619783900773038*^9}, {
   3.619784151070115*^9, 3.619784156280505*^9}, 3.619785514338372*^9, {
   3.619785972708309*^9, 3.619786019475816*^9}, {3.619786083601817*^9, 
   3.619786093888351*^9}, {3.619857144178598*^9, 3.619857213702058*^9}, {
   3.619869231743819*^9, 3.6198692320048227`*^9}, {3.620029489358922*^9, 
   3.620029490691779*^9}, {3.620029774040443*^9, 3.620029779944014*^9}, {
   3.620119688367395*^9, 3.6201196947666893`*^9}, {3.6209856050990057`*^9, 
   3.620985612460287*^9}, {3.6209857875864487`*^9, 3.620985905225539*^9}, {
   3.620992107772296*^9, 3.620992108265216*^9}, {3.622196781675029*^9, 
   3.622196781986261*^9}, {3.622197274396171*^9, 3.622197279276333*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Division", " ", "test", " ", 
    RowBox[{"(", 
     RowBox[{"square", "-", 
      RowBox[{"free", " ", "case"}]}], ")"}], " ", "for", " ", "the", " ", 
    "primes", " ", "which", " ", "satisfy", " ", "the", " ", "second", " ", 
    RowBox[{"condition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"divTest2Free2Z2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
     "]"}], ":=", 
    RowBox[{"IsDivComp", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], ",", 
      RowBox[{"p", "^", "2"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.619785518989394*^9, 3.619785577069911*^9}, {
  3.6198572175484047`*^9, 3.619857222627846*^9}, {3.6200294918495903`*^9, 
  3.620029492851513*^9}, {3.6200297830962353`*^9, 3.62002978731921*^9}, {
  3.6201196817210617`*^9, 3.620119686009532*^9}, {3.620985581699203*^9, 
  3.6209855881007557`*^9}, {3.620985691044826*^9, 3.620985715406868*^9}, {
  3.620985976914999*^9, 3.620985978114326*^9}, {3.622196775856139*^9, 
  3.6221967804294443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "for", " ", "square"}], "-", 
    RowBox[{
     RowBox[{"free", " ", "'"}], 
     RowBox[{"visibility", "'"}], " ", "of", " ", "an", " ", "element", " ", 
     "of", " ", 
     RowBox[{
      RowBox[{"Z", "[", 
       RowBox[{"Sqrt", "[", "2", "]"}], "]"}], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"visibility2FreeZ2", "[", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"norm", ",", "primes", ",", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"m", "-", "n"}], ",", "2"}], "]"}], "\[Equal]", "0"}], "&&", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"m", ",", "2"}], "]"}], "\[Equal]", "0"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norm", "=", 
        RowBox[{"algnormZ2", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "norm", "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"primes", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
          RowBox[{"FactorInteger", "[", 
           RowBox[{"Abs", "[", "norm", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Catch", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"t", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"pCond1Z2", "[", "t", "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"divTest2Free1Z2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                   RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"pCond2Z2", "[", "t", "]"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"divTest2Free2Z2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                    RowBox[{"Throw", "[", "False", "]"}]}], "]"}]}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "]"}], ",", "primes"}], "]"}],
            ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "===", "False"}], ",", 
         RowBox[{"Return", "[", "False", "]"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6209845072341547`*^9, 3.620984507566925*^9}, {
   3.6209845592479763`*^9, 3.620984644609786*^9}, {3.6209846779818487`*^9, 
   3.620984695771398*^9}, {3.620984788540822*^9, 3.620984789227524*^9}, {
   3.620985590635219*^9, 3.6209855958039217`*^9}, {3.620985915049739*^9, 
   3.620985915437443*^9}, {3.620992117788231*^9, 3.6209921183025103`*^9}, 
   3.621597731060742*^9, {3.622196792977038*^9, 3.622196803821179*^9}, {
   3.6221972878442907`*^9, 3.622197291593122*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "vTableZ2", ",", "miEmbedZ2", ",", "vDrawZ2", ",", "checkBoxZ2", ",", 
    "cutBoxZ2"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.620986923689395*^9, 3.62098694047298*^9}, {
  3.6221972998646393`*^9, 3.622197308184389*^9}, {3.6221984031500483`*^9, 
  3.622198406014049*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Generate", " ", "a", " ", "list", " ", "of", " ", "elements", " ", 
    RowBox[{"(", 
     RowBox[{"which", " ", "later", " ", "become", " ", "vertices"}], ")"}], 
    " ", "of", " ", 
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{"Sqrt", "[", "2", "]"}], "]"}], "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vTableZ2", "[", "r_Integer", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"-", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"r", "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}]}], ",", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"r", "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}]}], "}"}]}], "]"}], ",", 
      "1"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.619781494599867*^9, 3.619781551200976*^9}, {
  3.619784215937667*^9, 3.619784236566516*^9}, {3.61985731503244*^9, 
  3.61985737236108*^9}, {3.620974068980427*^9, 3.620974070050601*^9}, {
  3.622197301387404*^9, 3.622197301695937*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "miEmbedZ2", " ", "takes", " ", "an", " ", "element", " ", "of", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"Sqrt", "[", "2", "]"}], "]"}], " ", "in", " ", "the", " ", 
     "form", " ", 
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "b"}], "}"}]}], ",", " ", "where"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"a", " ", "+", " ", 
     RowBox[{"b", " ", "*", " ", 
      RowBox[{"Sqrt", "[", "2", "]"}], " ", "and", " ", "then", " ", "maps", 
      " ", "it", " ", "to", " ", "the", " ", "Minkowski", " ", 
      RowBox[{"embedding", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"miEmbedZ2", "[", 
     RowBox[{"{", 
      RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", "*", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "+", 
     RowBox[{"b", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sqrt", "[", "2", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6198578169468813`*^9, 3.619857859527462*^9}, {
  3.6201187332095137`*^9, 3.620118794508374*^9}, {3.620974099587322*^9, 
  3.6209741109946833`*^9}, {3.6221973095517*^9, 3.622197312794186*^9}, {
  3.622199522320009*^9, 3.622199522593398*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Map", " ", "elements", " ", "to", " ", "Minkowski", " ", "embedding", " ",
     "and", " ", "draw", " ", "the", " ", "resulting", " ", 
    RowBox[{"set", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vDrawZ2", "[", 
     RowBox[{"in_", ",", 
      RowBox[{"axes_:", "True"}], ",", 
      RowBox[{"pstyle_:", "Automatic"}]}], "]"}], ":=", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"miEmbedZ2", ",", "in"}], "]"}], ",", 
      RowBox[{"Axes", "\[Rule]", "axes"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "pstyle"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.619781564341761*^9, 3.619781571622548*^9}, {
   3.619781678051299*^9, 3.619781744963448*^9}, {3.619857333669952*^9, 
   3.619857335687954*^9}, {3.61985738479467*^9, 3.619857402345852*^9}, 
   3.619857865138164*^9, {3.621075075225223*^9, 3.621075077767185*^9}, {
   3.621075396700665*^9, 3.6210754012430143`*^9}, {3.6210755407444553`*^9, 
   3.621075575206708*^9}, {3.6210758995287952`*^9, 3.621075952265253*^9}, {
   3.622197319861064*^9, 3.6221973257057343`*^9}}],

Cell[BoxData[
 RowBox[{"vDrawZ2", "[", 
  RowBox[{
   RowBox[{"vTableZ2", "[", "40", "]"}], ",", "False", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "[", "Tiny", "]"}], ",", "Black"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.619781748359747*^9, 3.619781752806663*^9}, {
  3.61978396130613*^9, 3.619783964617319*^9}, {3.619784003049782*^9, 
  3.6197840031935797`*^9}, {3.621075937048728*^9, 3.621075944687645*^9}, {
  3.6221973285683193`*^9, 3.622197331447811*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkBoxZ2", "[", 
    RowBox[{"in_", ",", "xmax_", ",", "ymax_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "mi", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mi", "=", 
       RowBox[{"miEmbedZ2", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Part", "[", 
           RowBox[{"mi", ",", "1"}], "]"}], "]"}], "\[LessEqual]", "xmax"}], "&&", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Part", "[", 
           RowBox[{"mi", ",", "2"}], "]"}], "]"}], "\[LessEqual]", "ymax"}]}],
        "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6198578778239822`*^9, 3.6198579238938227`*^9}, 
   3.620992176424972*^9, {3.622197345256403*^9, 3.622197347481656*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cutBoxZ2", "[", 
    RowBox[{"in_", ",", "xmax_", ",", "ymax_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"in", ",", 
     RowBox[{
      RowBox[{"checkBoxZ2", "[", 
       RowBox[{"#", ",", "xmax", ",", "ymax"}], "]"}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6198576540182247`*^9, 3.619857759033643*^9}, {
  3.619857928770377*^9, 3.61985793651514*^9}, {3.6221973493366327`*^9, 
  3.622197351332755*^9}}],

Cell[BoxData[
 RowBox[{"vDrawZ2", "[", 
  RowBox[{"cutBoxZ2", "[", 
   RowBox[{
    RowBox[{"vTableZ2", "[", "80", "]"}], ",", "70", ",", "70"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.619857742328286*^9, 3.6198577896418867`*^9}, {
  3.6198579422444*^9, 3.619857965667266*^9}, {3.62219735344668*^9, 
  3.622197353768771*^9}, {3.622198411133609*^9, 3.622198411805193*^9}, {
  3.622198824778659*^9, 3.622198825162764*^9}}],

Cell[BoxData[
 RowBox[{"vDrawZ2", "[", 
  RowBox[{
   RowBox[{"cutBoxZ2", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"vTableZ2", "[", "120", "]"}], ",", "visibility2FreeZ2"}], 
      "]"}], ",", "100", ",", "100"}], "]"}], ",", "False", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "[", "Tiny", "]"}], ",", "Black"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6197839675960913`*^9, 3.619784000218712*^9}, {
   3.619785715544984*^9, 3.619785811882365*^9}, {3.619786239497984*^9, 
   3.619786252279276*^9}, {3.619786333140387*^9, 3.619786333844055*^9}, {
   3.6197868202529373`*^9, 3.619786841495427*^9}, {3.6198579850460043`*^9, 
   3.619857992834668*^9}, {3.6199525906864033`*^9, 3.6199525917293797`*^9}, {
   3.620984712838964*^9, 3.620984759086031*^9}, {3.621075005677887*^9, 
   3.621075058314118*^9}, {3.621075194280298*^9, 3.6210752118504887`*^9}, {
   3.621075278660136*^9, 3.621075285648448*^9}, 3.6210760407890263`*^9, 
   3.621076141962184*^9, {3.621076180639751*^9, 3.6210761813132668`*^9}, 
   3.621597737341627*^9, {3.6221973547115993`*^9, 3.622197356577179*^9}, {
   3.622198416171481*^9, 3.622198416550582*^9}, {3.6221986967418756`*^9, 
   3.622198697077777*^9}}],

Cell[BoxData[
 RowBox[{"vDrawZ2", "[", 
  RowBox[{
   RowBox[{"cutBoxZ2", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"vTableZ2", "[", "20", "]"}], ",", "visibility2FreeZ2"}], 
      "]"}], ",", "22", ",", "22"}], "]"}], ",", "False", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.621076238280883*^9, 3.621076263422124*^9}, 
   3.621597738462523*^9, {3.622197357516844*^9, 3.6221973599026747`*^9}, {
   3.622198420521358*^9, 3.6221984209706583`*^9}, {3.622198698857942*^9, 
   3.622198699169002*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"%", ",", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Arrowheads", "[", "0.011", "]"}], ",", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}], "}"}], "]"}]}], 
     "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6210749230748987`*^9, 3.621074963805037*^9}, {
  3.621075096504274*^9, 3.6210751750988827`*^9}, {3.621075215512795*^9, 
  3.6210752762611303`*^9}}],

Cell[BoxData[
 RowBox[{"vDrawZ2", "[", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"vTableZ2", "[", "80", "]"}], ",", "visibility2FreeZ2"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6198689749286203`*^9, 3.6198689776814737`*^9}, {
   3.619952580947229*^9, 3.619952581861829*^9}, 3.6215977418083553`*^9, {
   3.622197368292054*^9, 3.622197370613758*^9}, {3.622198704200079*^9, 
   3.622198704439631*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Compute", " ", "numerical", " ", 
    RowBox[{"density", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{"x", ",", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"vTableZ2", "[", "x", "]"}], ",", "visibility2FreeZ2"}], 
         "]"}], "]"}], "/", 
       RowBox[{"Length", "[", 
        RowBox[{"vTableZ2", "[", "x", "]"}], "]"}]}], "]"}]}], "]"}], "[", 
   "180", "]"}]}]], "Input",
 CellChangeTimes->{{3.619786868906992*^9, 3.619786953303048*^9}, {
   3.619787405096387*^9, 3.619787430998679*^9}, {3.619869017198666*^9, 
   3.619869018439817*^9}, {3.6198693340410147`*^9, 3.619869334778823*^9}, {
   3.619952624536458*^9, 3.619952627937566*^9}, {3.6201197281680727`*^9, 
   3.620119756233715*^9}, 3.62159774468929*^9, {3.6221974113472443`*^9, 
   3.62219741166951*^9}, {3.622198453950478*^9, 3.6221984560701942`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Function", "[", 
   RowBox[{"x", ",", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"vTableZ2", "[", "x", "]"}], ",", "visibility2FreeZ2"}], 
        "]"}], "]"}], "/", 
      RowBox[{"Length", "[", 
       RowBox[{"vTableZ2", "[", "x", "]"}], "]"}]}], "]"}]}], "]"}], "[", 
  "150", "]"}]], "Input",
 CellChangeTimes->{
  3.619869038881549*^9, {3.6198693359413853`*^9, 3.6198693367298813`*^9}, {
   3.6199526286126013`*^9, 3.619952629548936*^9}, 3.621597745630142*^9, {
   3.6221974129763117`*^9, 3.622197413253587*^9}, {3.6221984576158133`*^9, 
   3.622198459311124*^9}}],

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Sqrt", "[", "2", "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"DirichletL", "[", 
      RowBox[{"8", ",", "1", ",", "2"}], "]"}], "*", 
     RowBox[{"Zeta", "[", "2", "]"}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.619787290126204*^9, 3.619787373784911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Compute", " ", "exact", " ", 
    RowBox[{"density", ".", " ", "Seems"}], " ", "to", " ", "match", " ", 
    "the", " ", "numerics", " ", "quite", " ", 
    RowBox[{"well", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"N", "[", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirichletL", "[", 
       RowBox[{"8", ",", "2", ",", "2"}], "]"}], "*", 
      RowBox[{"Zeta", "[", "2", "]"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.619855715644393*^9, 3.619855728651726*^9}, {
  3.619855806825775*^9, 3.619855826774078*^9}, {3.6201197695405083`*^9, 
  3.620119797588119*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"DirichletL", "[", 
      RowBox[{"8", ",", "2", ",", "2"}], "]"}], "*", 
     RowBox[{"Zeta", "[", "2", "]"}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.61985567087335*^9, 3.619855677667238*^9}, {
  3.619855801959425*^9, 3.619855805863997*^9}, {3.6198739415113573`*^9, 
  3.6198739535082912`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "DivZ2", ",", "IsDivZ2", ",", "denomZ2", ",", "pTest1Z2", ",", 
    "factorZ2"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.620986955652668*^9, 3.6209869741477213`*^9}, {
  3.622197525934187*^9, 3.62219753113597*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Let", " ", "x1"}], " ", "=", " ", 
     RowBox[{"a1", " ", "+", " ", 
      RowBox[{"b1", " ", "*", " ", 
       RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], ",", " ", 
    RowBox[{"x2", " ", "=", " ", 
     RowBox[{"a2", " ", "+", " ", 
      RowBox[{"b2", " ", "*", " ", 
       RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], ",", " ", 
    RowBox[{"then", " ", "this"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computes", " ", 
     RowBox[{"x1", "/", "x2"}], " ", "in", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"Sqrt", "[", "2", "]"}], "]"}]}], ",", " ", 
    RowBox[{"assuming", " ", "that", " ", "x2", " ", "divides", " ", 
     RowBox[{"x1", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DivZ2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"algnormZ2", "[", 
         RowBox[{"{", 
          RowBox[{"a2", ",", "b2"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{
         RowBox[{"a1", "*", "a2"}], "-", 
         RowBox[{"2", "*", "b1", "*", "b2"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"a2", "*", "b1"}], "-", 
         RowBox[{"a1", "*", "b2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Divide", "[", 
          RowBox[{"x", ",", "n"}], "]"}], ",", 
         RowBox[{"Divide", "[", 
          RowBox[{"y", ",", "n"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.619870077769528*^9, 3.619870089626251*^9}, {
  3.61987029935714*^9, 3.619870375553146*^9}, {3.619870438226955*^9, 
  3.6198705136213503`*^9}, {3.619873162262583*^9, 3.619873169543412*^9}, {
  3.620973789472273*^9, 3.620973801794221*^9}, {3.620992125317387*^9, 
  3.620992125830934*^9}, {3.62219743050638*^9, 3.6221974313666983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "if", " ", "x2", " ", "divides", " ", "x1", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "x1", " ", "and", " ", "x2", " ", "defined", " ", "like", " ", "in", 
       " ", "DivZ2"}], ")"}], "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IsDivZ2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1_Integer", ",", " ", "b1_Integer"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a2_Integer", ",", " ", "b2_Integer"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"algnormZ2", "[", 
         RowBox[{"{", 
          RowBox[{"a2", ",", "b2"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{
         RowBox[{"a1", "*", "a2"}], "-", 
         RowBox[{"2", "*", "b1", "*", "b2"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"a2", "*", "b1"}], "-", 
         RowBox[{"a1", "*", "b2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"x", ",", "n"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"y", ",", "n"}], "]"}], "\[Equal]", "0"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6198731534780912`*^9, 3.619873240915715*^9}, {
   3.619942478161201*^9, 3.619942480352193*^9}, {3.62097380817476*^9, 
   3.620973819532188*^9}, {3.620992127574956*^9, 3.620992128111286*^9}, 
   3.622197433758936*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Let", " ", "x"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", " ", "+", " ", 
        RowBox[{"b", " ", "*", " ", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], ")"}], " ", "/", " ", "c"}]}], 
    ",", " ", 
    RowBox[{
    "then", " ", "this", " ", "computes", " ", "the", " ", "denominator"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "the", " ", "Fourier", " ", "module", " ", 
    RowBox[{"Z", "[", 
     RowBox[{"Sqrt", "[", "2", "]"}], "]"}], " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sqrt", "[", "2", "]"}], "/", "4"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"denomZ2", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
      "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "g"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"4", "*", "b"}], ",", 
          RowBox[{"2", "*", "a"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"GCDZ2", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "0"}], "}"}], ",", "x"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"DivZ2", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "0"}], "}"}], ",", "g"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.619869743289091*^9, 3.619869840548119*^9}, {
  3.619869881988481*^9, 3.619869901571953*^9}, {3.619869938706779*^9, 
  3.619870057295339*^9}, {3.6198705373097486`*^9, 3.6198706132588987`*^9}, {
  3.619945370148549*^9, 3.619945370372457*^9}, {3.619952809587124*^9, 
  3.619952811938223*^9}, {3.620121968644101*^9, 3.620121976514224*^9}, {
  3.620122063806472*^9, 3.6201220661795607`*^9}, {3.620122339305271*^9, 
  3.620122341404407*^9}, {3.6201225472755327`*^9, 3.620122549069265*^9}, {
  3.620122613651066*^9, 3.6201226154981413`*^9}, {3.620992130521721*^9, 
  3.620992131072899*^9}, {3.6221974431588287`*^9, 3.622197443511054*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pTest1Z2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"FindTupleZ2", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"ConjZ2", "[", "t", "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"IsDivZ2", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}], ",", "#"}], "]"}], "&"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.619871615144292*^9, 3.619871638337598*^9}, {
   3.619872907468112*^9, 3.619872934523902*^9}, {3.619872966938579*^9, 
   3.619872969274922*^9}, {3.61987301292078*^9, 3.6198730773730288`*^9}, {
   3.6198732499545717`*^9, 3.619873323760376*^9}, {3.619873359767744*^9, 
   3.619873434585741*^9}, 3.619873574384617*^9, {3.620986000031855*^9, 
   3.6209860027718277`*^9}, 3.620992133229203*^9, {3.6221974476710157`*^9, 
   3.62219744797604*^9}, {3.622197486516741*^9, 3.622197486852006*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Generate", " ", "a", " ", "list", " ", "of", " ", "primes", " ", 
     RowBox[{"(", 
      RowBox[{"in", " ", 
       RowBox[{"Z", "[", 
        RowBox[{"Sqrt", "[", "2", "]"}], "]"}]}], ")"}], " ", "that", " ", 
     "divide", " ", "m"}], " ", "+", " ", 
    RowBox[{"n", " ", "*", " ", 
     RowBox[{
      RowBox[{"Sqrt", "[", "2", "]"}], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"factorZ2", "[", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"norm", ",", "nprimes"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"norm", "=", 
        RowBox[{"algnormZ2", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "norm", "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nprimes", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
          RowBox[{"FactorInteger", "[", 
           RowBox[{"Abs", "[", "norm", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"x", ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"x", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], "}"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"if", " ", "we", " ", "encounter", " ", "the", " ", 
                  RowBox[{"prime", " ", "'"}], 
                  RowBox[{"2", "'"}]}], ",", " ", 
                 RowBox[{
                 "we", " ", "have", " ", "a", " ", "factor", " ", "of", " ", 
                  RowBox[{"Sqrt", "[", "2", "]"}]}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"pCond2Z2", "[", "x", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "0"}], "}"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"pCond1Z2", "[", "x", "]"}], ",", 
                   RowBox[{"pTest1Z2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "x"}], "]"}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
           ",", "nprimes"}], "]"}], ",", "1"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.619870694138597*^9, 3.619870785255114*^9}, {
   3.61987081734597*^9, 3.619870869282342*^9}, {3.619870937482237*^9, 
   3.6198709875041428`*^9}, {3.619871076396562*^9, 3.619871109227108*^9}, {
   3.6198714257139378`*^9, 3.619871610932333*^9}, {3.619871666884804*^9, 
   3.6198717709704933`*^9}, {3.6198718280237226`*^9, 3.61987183861136*^9}, {
   3.619872042686708*^9, 3.619872083790146*^9}, {3.619873029598815*^9, 
   3.6198730315104713`*^9}, {3.619873499612296*^9, 3.61987352171846*^9}, {
   3.619873572234585*^9, 3.6198736134168*^9}, {3.619944168582335*^9, 
   3.619944170882987*^9}, {3.619944361979033*^9, 3.619944368991811*^9}, {
   3.619944550758829*^9, 3.619944567277446*^9}, {3.619944655923798*^9, 
   3.619944678108797*^9}, 3.6199447227543173`*^9, {3.61994479674662*^9, 
   3.619944802984767*^9}, {3.620126138706602*^9, 3.620126142957965*^9}, {
   3.62097339007845*^9, 3.6209733976671247`*^9}, {3.6209854886528683`*^9, 
   3.620985514735106*^9}, {3.6209859942656813`*^9, 3.620985997001423*^9}, 
   3.6209921352697163`*^9, {3.62219746655438*^9, 3.6221974796245193`*^9}, {
   3.622197518760141*^9, 3.6221975231497*^9}, {3.622443665753068*^9, 
   3.622443701625383*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testFactorZ2", "[", 
    RowBox[{"{", 
     RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IsDivZ2", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], ",", "#"}], "]"}], "&"}], ",", 
       RowBox[{"factorZ2", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"factorZ2", "[", 
  RowBox[{"{", 
   RowBox[{"13", ",", "7"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6198716557269506`*^9, 3.6198716607777023`*^9}, {
  3.619871809097534*^9, 3.619871816903923*^9}, {3.619871848728805*^9, 
  3.6198718610891123`*^9}, {3.619874007703038*^9, 3.619874009491198*^9}, {
  3.6221975641416817`*^9, 3.6221975664453783`*^9}}],

Cell[BoxData[
 RowBox[{"Union", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"testFactorZ2", "[", "#", "]"}], "]"}], "&"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"RandomInteger", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "400"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"100", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], "]"}], ",", "1"}], "]"}], "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "zetaZ2", ",", "intensityZ2", ",", "qCoprime", ",", "qCoprimeCheck"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"vTableQ2", ",", "vTableQ2Recip", ",", "ReduceQ2"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.620986982071972*^9, 3.62098700781362*^9}, {
  3.622197539870987*^9, 3.6221975429756308`*^9}, {3.622198568338558*^9, 
  3.622198587683249*^9}, {3.622198864408379*^9, 3.622198864775817*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zetaZ2", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirichletL", "[", 
       RowBox[{"8", ",", "2", ",", "2"}], "]"}], "*", 
      RowBox[{"Zeta", "[", "2", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "zetaZ2", "]"}]}], "Input",
 CellChangeTimes->{{3.619873904221664*^9, 3.619873922244322*^9}, {
  3.619873962058263*^9, 3.6198739637318087`*^9}, {3.6221975537983294`*^9, 
  3.622197556462962*^9}, {3.622289741558078*^9, 3.6222897418677883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Compute", " ", "the", " ", "intensity", " ", "of", " ", "an", " ", 
     "element", " ", "x"}], " ", "=", " ", 
    RowBox[{"m", " ", "+", " ", 
     RowBox[{"n", " ", "*", " ", 
      RowBox[{"Sqrt", "[", "2", "]"}], " ", "of", " ", 
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{"Sqrt", "[", "2", "]"}], "]"}], "."}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "of", " ", "this", " ", "function", " ", "are", " ", "going",
     " ", "to", " ", "be", " ", "the", " ", "denominators", " ", "of", " ", 
    "elements", " ", "of", " ", 
    RowBox[{
     RowBox[{"Q", "[", 
      RowBox[{"Sqrt", "[", "2", "]"}], "]"}], "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"intensityZ2", "[", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "prod"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"m", "\[Equal]", "0"}], "&&", 
          RowBox[{"n", "\[Equal]", "0"}]}], ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{"Sqrt", "[", "2", "]"}], "*", "zetaZ2"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prod", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Times", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"algnormZ2", "[", "#", "]"}], "^", "2"}], "-", "1"}],
                ")"}]}], "&"}], ",", 
            RowBox[{"factorZ2", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"f", "*", "prod"}], ")"}], "^", "2"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.619873637185615*^9, 3.619873686575748*^9}, {
   3.619873729901864*^9, 3.619873839420842*^9}, 3.619873967551181*^9, {
   3.619874047381275*^9, 3.619874048863287*^9}, {3.619944854292705*^9, 
   3.619944872567794*^9}, {3.620119846568282*^9, 3.620119905763736*^9}, 
   3.620992143179669*^9, {3.622197544437027*^9, 3.622197549477878*^9}, 
   3.622198314167677*^9, {3.62219872095313*^9, 3.62219872202209*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Given", " ", "an", " ", "element", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", " ", "+", " ", 
        RowBox[{"b", " ", "*", " ", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], ")"}], " ", "/", " ", "c"}]}], 
    ",", " ", 
    RowBox[{
    "qCoprime", " ", "checks", " ", "that", " ", "this", " ", 
     "representations", " ", "can"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "not", " ", "be", " ", "reduced", " ", "any", " ", "further", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"the", " ", "integers", " ", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], " ", "are", " ", 
       "coprime"}], ")"}], ".", " ", "qCoprimeCheck"}], " ", "is", " ", 
    "just"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "consistency", " ", "check", " ", "to", " ", "verify", " ", 
    "that", " ", "this", " ", "approach", " ", "is", " ", "working", " ", 
    RowBox[{"correctly", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"qCoprime", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
       "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"GCD", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], "\[Equal]", "1"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"qCoprimeCheck", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
       "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", "c", "]"}], "==", "1"}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"a", ",", "c"}], "]"}], "\[NotEqual]", "0"}], "||", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"b", ",", "c"}], "]"}], "\[NotEqual]", "0"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.619952399696794*^9, 3.619952436908399*^9}, {
  3.619952497176071*^9, 3.6199524994182663`*^9}, {3.620024160691259*^9, 
  3.6200241620338383`*^9}, {3.620024377613407*^9, 3.620024396477621*^9}, {
  3.6200252110228662`*^9, 3.620025211195928*^9}, {3.620025321225504*^9, 
  3.6200253435099297`*^9}, {3.620028938224513*^9, 3.620028977065713*^9}, {
  3.620029031370316*^9, 3.620029072728915*^9}, {3.62002918979814*^9, 
  3.620029197089467*^9}, {3.62011992305595*^9, 3.620120019709882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "a", " ", "list", " ", "of", " ", "elements", " ", "of", 
    " ", 
    RowBox[{"Q", "[", 
     RowBox[{"Sqrt", "[", "2", "]"}], "]"}], " ", "in", " ", "the", " ", 
    "form", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", " ", "+", " ", 
       RowBox[{"b", " ", "*", " ", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], ")"}], " ", "/", " ", "2."}], 
    " ", "An", " ", "element"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"is", " ", "encoded", " ", "as", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", "c"}], "}"}], ".", " ", 
     "vTable"}], " ", 
    RowBox[{"(", 
     RowBox[{"see", " ", "above"}], ")"}], " ", "is", " ", "used", " ", "to", 
    " ", "generate", " ", "the", " ", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], " ", "part", " ", "of", " ", "the", " ", 
    
    RowBox[{"list", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Then", " ", "another", " ", 
    RowBox[{"pass", " ", "'"}], 
    RowBox[{"extends", "'"}], " ", "each", " ", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], " ", "with", " ", 
    RowBox[{"a", " ", "'"}], 
    RowBox[{"c", "'"}], " ", "in", " ", "the", " ", "range", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "...", ",", "s"}], "}"}], "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vTableQ2", "[", 
     RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"x", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "i"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "s"}], "}"}]}], "]"}]}], "]"}], ",", 
        
        RowBox[{"vTableZ2", "[", "r", "]"}]}], "]"}], ",", "1"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.619952181071632*^9, 3.619952341104929*^9}, {
  3.620120048233032*^9, 3.620120168615376*^9}, {3.62219856263548*^9, 
  3.622198564780178*^9}, {3.6221986269169493`*^9, 3.6221986272108583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", "vTableQ2"}], ",", " ", 
    RowBox[{
    "but", " ", "create", " ", "elements", " ", "with", " ", "respect", " ", 
     "to", " ", "the", " ", "basis", " ", "of", " ", "the", " ", "reciprocal",
      " ", 
     RowBox[{"lattice", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"vTableQ2Recip", "[", 
      RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"x", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{"x", ",", "1"}], "]"}]}], ",", 
                 RowBox[{"Part", "[", 
                  RowBox[{"x", ",", "2"}], "]"}]}], "}"}], ",", 
               RowBox[{"4", "*", "i"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "s"}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"vTableZ2", "[", "r", "]"}]}], "]"}], ",", "1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReduceQ2", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
       "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", "c"}], "}"}], "/", 
      RowBox[{"GCD", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.62012812724297*^9, 3.6201281851969147`*^9}, {
  3.620128787063671*^9, 3.62012887832969*^9}, {3.621162710772073*^9, 
  3.621162740132427*^9}, {3.62219863044972*^9, 3.622198638650427*^9}, {
  3.622198870401026*^9, 3.622198870848692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Alternate", " ", "version", " ", "of", " ", "vTableQ2Recip"}], 
    ",", " ", 
    RowBox[{"still", " ", "needs", " ", "some", " ", 
     RowBox[{"tuning", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vTableQ2RecipAlt", "[", 
     RowBox[{"r_", ",", "s_"}], "]"}], ":=", 
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", "*", "a"}], ",", "b"}], "}"}], ",", 
            RowBox[{"4", "*", "c"}]}], "}"}], "/", 
          RowBox[{"GCD", "[", 
           RowBox[{
            RowBox[{"2", "*", "a"}], ",", "b", ",", 
            RowBox[{"4", "*", "c"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "1", ",", "s"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"-", "r"}], ",", "r"}], "}"}]}], "]"}], ",", "2"}], "]"}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.62115631747123*^9, 3.621156334344005*^9}, {
   3.621158633503305*^9, 3.62115871441543*^9}, {3.621158750733858*^9, 
   3.621158786458164*^9}, 3.621158965543676*^9, {3.621160018943191*^9, 
   3.621160061004608*^9}, {3.621160313205762*^9, 3.621160315218381*^9}, {
   3.621162549581881*^9, 3.621162557291388*^9}, {3.621162760611322*^9, 
   3.621162772836043*^9}, {3.6211628649834557`*^9, 3.621162867791486*^9}, {
   3.621245785492442*^9, 3.621245786915353*^9}, {3.6221986470194607`*^9, 
   3.622198652004746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"testCoprime1", ",", "testCoprime2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "divTest3Free1Z2", ",", "divTest3Free2Z2", ",", "visiblity3FreeZ2"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6209870110785*^9, 3.620987034566658*^9}, {
  3.622198660708089*^9, 3.6221986642581863`*^9}}],

Cell[BoxData[
 RowBox[{"testCoprime1", "=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"vTableQ2", "[", 
     RowBox[{"4", ",", "2"}], "]"}], ",", "qCoprime"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.619952325280204*^9, 3.619952329771562*^9}, {
  3.619952441212504*^9, 3.619952462731978*^9}, {3.619953509809437*^9, 
  3.619953512047249*^9}, {3.620025128962571*^9, 3.62002513055717*^9}, {
  3.620029203759577*^9, 3.62002921953506*^9}, {3.622198671355536*^9, 
  3.62219867272506*^9}}],

Cell[BoxData[
 RowBox[{"testCoprime2", "=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"vTableQ2", "[", 
     RowBox[{"4", ",", "2"}], "]"}], ",", "qCoprimeCheck"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.62002534990795*^9, 3.620025350937018*^9}, {
  3.6200292128303223`*^9, 3.620029223518656*^9}, {3.622198674297676*^9, 
  3.622198675470551*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sort", "[", "testCoprime1", "]"}], "\[Equal]", 
  RowBox[{"Sort", "[", "testCoprime2", "]"}]}]], "Input",
 CellChangeTimes->{{3.6200292370746737`*^9, 3.6200292457687387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Division", " ", "test", " ", 
    RowBox[{"(", 
     RowBox[{"cube", "-", 
      RowBox[{"free", " ", "case"}]}], ")"}], " ", "for", " ", "the", " ", 
    "primes", " ", "which", " ", "satisfy", " ", "the", " ", "first", " ", 
    RowBox[{"condition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"divTest3Free1Z2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "a1", ",", "a2", ",", "b1", ",", "b2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{"FindTupleZ2", "[", "p", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"algnorm", 
          RowBox[{"(", "t", ")"}]}], " ", "=", " ", "p"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"a1", "=", 
        RowBox[{"CubeZ2", "[", "t", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"a1", " ", "=", " ", 
         RowBox[{"t", "^", "3"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"a2", "=", 
        RowBox[{"CubeZ2", "[", 
         RowBox[{"ConjZ2", "[", "t", "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"a2", " ", "=", " ", 
         RowBox[{"conj", 
          RowBox[{
           RowBox[{"(", "t", ")"}], "^", "3"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"b1", "=", 
        RowBox[{"MultZ2", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], ",", "a1"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"b1", " ", "=", " ", 
         RowBox[{"x", " ", "*", " ", "a1"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"b2", "=", 
        RowBox[{"MultZ2", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], ",", "a2"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"b2", " ", "=", " ", 
         RowBox[{"x", " ", "*", " ", "a2"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"IsDivComp", "[", 
          RowBox[{"b1", ",", 
           RowBox[{"p", "^", "3"}]}], "]"}], "||", 
         RowBox[{"IsDivComp", "[", 
          RowBox[{"b2", ",", 
           RowBox[{"p", "^", "3"}]}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.620029824822589*^9, 3.620029827440364*^9}, {
   3.620029913161707*^9, 3.6200299424609423`*^9}, {3.620029989584403*^9, 
   3.620030164174286*^9}, {3.620030302979891*^9, 3.6200303422027807`*^9}, {
   3.620031412604641*^9, 3.62003142536875*^9}, {3.620032454007431*^9, 
   3.6200324553895397`*^9}, {3.6200325050940237`*^9, 3.620032511092608*^9}, {
   3.620984967008703*^9, 3.620985001375786*^9}, 3.620992152253439*^9, {
   3.622197609507613*^9, 3.622197616595689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Division", " ", "test", " ", 
    RowBox[{"(", 
     RowBox[{"cube", "-", 
      RowBox[{"free", " ", "case"}]}], ")"}], " ", "for", " ", "the", " ", 
    "primes", " ", "which", " ", "satisfy", " ", "the", " ", "second", " ", 
    RowBox[{"condition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"divTest3Free2Z2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], ",", "p_Integer"}], 
     "]"}], ":=", 
    RowBox[{"IsDivComp", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], ",", 
      RowBox[{"p", "^", "3"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6200298917623367`*^9, 3.620029920546701*^9}, {
  3.6200303622610397`*^9, 3.620030386403392*^9}, {3.620031012900515*^9, 
  3.620031021609419*^9}, {3.620984977801062*^9, 3.620984988841364*^9}, {
  3.622197617875909*^9, 3.622197619448166*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "for", " ", "cube"}], "-", 
    RowBox[{
     RowBox[{"free", " ", "'"}], 
     RowBox[{"visibility", "'"}], " ", "of", " ", "an", " ", "element", " ", 
     "of", " ", 
     RowBox[{
      RowBox[{"Z", "[", 
       RowBox[{"Sqrt", "[", "2", "]"}], "]"}], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"visiblity3FreeZ2", "[", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"norm", ",", "primes", ",", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsDivZ2", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"check", " ", "if", " ", "divisible", " ", "by", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Sqrt", "[", "2", "]"}], ")"}], "^", "3"}]}], " ", "=", 
         " ", 
         RowBox[{"2", "*", 
          RowBox[{"Sqrt", "[", "2", "]"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"norm", "=", 
        RowBox[{"algnormZ2", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "norm", "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"primes", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
          RowBox[{"FactorInteger", "[", 
           RowBox[{"Abs", "[", "norm", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"This", " ", 
          RowBox[{"catch", "/", "throw"}], " ", "construction", " ", "is", 
          " ", "a", " ", "bit", " ", "awkward"}], "..."}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Catch", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"t", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"pCond1Z2", "[", "t", "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"divTest3Free1Z2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                   RowBox[{"Throw", "[", "False", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"pCond2Z2", "[", "t", "]"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"divTest3Free2Z2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m", ",", "n"}], "}"}], ",", "t"}], "]"}], ",", 
                    RowBox[{"Throw", "[", "False", "]"}]}], "]"}]}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "]"}], ",", "primes"}], "]"}],
            ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "===", "False"}], ",", 
         RowBox[{"Return", "[", "False", "]"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6199535525113487`*^9, 3.619953575231226*^9}, {
   3.619953612848694*^9, 3.6199536132223063`*^9}, {3.619953660010172*^9, 
   3.619953663082095*^9}, {3.620029546418332*^9, 3.62002972662549*^9}, {
   3.620029835101247*^9, 3.620029838988586*^9}, {3.62003049362226*^9, 
   3.620030550871622*^9}, {3.6200314743936367`*^9, 3.620031479469636*^9}, {
   3.620032514629591*^9, 3.620032518993249*^9}, {3.62003257182768*^9, 
   3.620032572387844*^9}, {3.620032611521559*^9, 3.620032667484703*^9}, {
   3.620032962005064*^9, 3.6200329719056892`*^9}, {3.620033232073316*^9, 
   3.620033280442276*^9}, {3.620036612357318*^9, 3.620036640040122*^9}, {
   3.620036782050909*^9, 3.620036785827087*^9}, {3.620037500217462*^9, 
   3.62003750626963*^9}, {3.6200377322552032`*^9, 3.6200377694990463`*^9}, {
   3.6201155835683527`*^9, 3.6201155944802637`*^9}, {3.6201158851882477`*^9, 
   3.620115887589025*^9}, {3.620116059741723*^9, 3.620116061120515*^9}, {
   3.6201195164984426`*^9, 3.620119516920904*^9}, {3.620985019153273*^9, 
   3.6209850432812767`*^9}, 3.620985123418507*^9, 3.620992154848466*^9, {
   3.62219762309834*^9, 3.62219763398905*^9}, {3.6224436234377604`*^9, 
   3.622443652029354*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"miEmbedQ2", ",", "miEmbedQ2Trans", ",", "intensityPlotZ2"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"AlwaysTrue", ",", "testCutZ2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6209870421254683`*^9, 3.620987065253797*^9}, {
  3.622197692233786*^9, 3.622197692522285*^9}, {3.622198736259478*^9, 
  3.622198750085225*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "miEmbedQ2", " ", "takes", " ", "an", " ", "element", " ", "of", " ", 
     RowBox[{"Q", "[", 
      RowBox[{"Sqrt", "[", "2", "]"}], "]"}]}], ",", " ", 
    RowBox[{"written", " ", "in", " ", "the", " ", "form"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"x", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", " ", "+", " ", 
        RowBox[{"b", " ", "*", " ", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], ")"}], " ", "/", " ", "c"}]}], 
    ",", " ", 
    RowBox[{
    "and", " ", "maps", " ", "x", " ", "to", " ", "the", " ", "Minkowski", 
     " ", 
     RowBox[{"embedding", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"miEmbedQ2", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
      "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"miEmbedZ2", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "]"}], "/", "c"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.619952938371717*^9, 3.619952977046823*^9}, {
   3.620037483343564*^9, 3.620037488420363*^9}, 3.620037710265106*^9, {
   3.620037902032631*^9, 3.620037997883891*^9}, {3.620118372859488*^9, 
   3.6201184426347933`*^9}, {3.620985424538875*^9, 3.62098543552855*^9}, {
   3.622197959874737*^9, 3.622197983320629*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Do", " ", "the", " ", "same", " ", "as", " ", "miEmbedQ2"}], ",",
     " ", 
    RowBox[{
    "but", " ", "first", " ", "map", " ", "the", " ", "element", " ", "x", 
     " ", "to", " ", 
     RowBox[{"M", "^", "star"}]}], ",", " ", "where"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"M", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"Sqrt", "[", "2", "]"}], "]"}], ".", " ", "In"}], " ", "this", 
     " ", "case", " ", "this", " ", "corresponds", " ", "to", " ", 
     "multiplication", " ", "with", " ", 
     RowBox[{
      RowBox[{"Sqrt", "[", "2", "]"}], "/", "4."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"miEmbedQ2Trans", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_Integer", ",", "b_Integer"}], "}"}], ",", "c_Integer"}], 
      "}"}], "]"}], ":=", 
    RowBox[{"miEmbedQ2", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", "b"}], ",", "a"}], "}"}], ",", 
       RowBox[{"4", "*", "c"}]}], "}"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.620118446788658*^9, 3.620118555222925*^9}, {
   3.622197997105282*^9, 3.622198009850988*^9}, 3.6221988861588*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intensityPlotZ2", "[", 
    RowBox[{"in_", ",", "scaleFunc_", ",", "cutFunc_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temp", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"denomZ2", "[", "#", "]"}]}], "}"}], "&"}], ",", 
         RowBox[{"Select", "[", 
          RowBox[{"in", ",", "cutFunc"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"miEmbedQ2", "[", 
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"scaleFunc", "[", 
             RowBox[{"N", "[", 
              RowBox[{"intensityZ2", "[", 
               RowBox[{"Part", "[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
          "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", 
          RowBox[{"temp", ",", 
           RowBox[{
            RowBox[{"visiblity3FreeZ2", "[", 
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}]}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.619952752163643*^9, 3.619952826253797*^9}, {
   3.619952881084046*^9, 3.619952889958048*^9}, {3.61995298138379*^9, 
   3.619953029897015*^9}, {3.619953096439281*^9, 3.61995314640317*^9}, {
   3.619953188259636*^9, 3.6199531944669333`*^9}, {3.619953296957506*^9, 
   3.619953338077096*^9}, {3.619953428923643*^9, 3.619953439912839*^9}, {
   3.619953615970937*^9, 3.619953812955925*^9}, 3.620038002829151*^9, {
   3.620039160569902*^9, 3.620039160961779*^9}, {3.620039195601205*^9, 
   3.620039196592175*^9}, {3.620039228863549*^9, 3.6200392313751173`*^9}, {
   3.620039505854944*^9, 3.620039506436041*^9}, {3.620115641344788*^9, 
   3.620115642215938*^9}, {3.6201158232492437`*^9, 3.620115834512969*^9}, {
   3.620116923528578*^9, 3.620116930455615*^9}, {3.620116980037177*^9, 
   3.6201170295215483`*^9}, {3.620117890497157*^9, 3.620117943983944*^9}, {
   3.620121530133953*^9, 3.620121530901464*^9}, {3.6201264451402283`*^9, 
   3.620126464435596*^9}, {3.620126610367135*^9, 3.620126613230525*^9}, {
   3.6201272651910763`*^9, 3.620127267011813*^9}, {3.620127335297608*^9, 
   3.620127335921105*^9}, 3.62099215782778*^9, {3.621163055269927*^9, 
   3.621163066647855*^9}, {3.621245974831028*^9, 3.621246001663596*^9}, {
   3.621246040317751*^9, 3.6212460418664227`*^9}, {3.621246166202718*^9, 
   3.6212461675923033`*^9}, {3.621246327161066*^9, 3.621246328775339*^9}, {
   3.621246447283495*^9, 3.6212464677875643`*^9}, {3.621246606710445*^9, 
   3.621246609622315*^9}, {3.6212468902845783`*^9, 3.621246892473812*^9}, {
   3.6212469276264677`*^9, 3.6212469431151648`*^9}, 3.621246987929963*^9, 
   3.621247063046648*^9, {3.6212493058391247`*^9, 3.621249308605258*^9}, {
   3.622197661071347*^9, 3.622197688782362*^9}, {3.62219792362153*^9, 
   3.622197924005508*^9}, {3.6221980128373938`*^9, 3.6221980144570627`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toSage", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], ",", "r_"}], "}"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<circle((\>\"", ",", 
     RowBox[{"ToString", "[", "x", "]"}], ",", "\"\<,\>\"", ",", 
     RowBox[{"ToString", "[", "y", "]"}], ",", "\[IndentingNewLine]", 
     "\"\<),\>\"", ",", 
     RowBox[{"ToString", "[", "r", "]"}], ",", 
     "\"\<,color='black',thickness=0.5)\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.621067498719442*^9, 3.6210675042242517`*^9}, {
   3.621067900978815*^9, 3.621067913905752*^9}, 3.621068105685741*^9, 
   3.621068138426297*^9, 3.621068458156562*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intensityExportZ2", "[", 
    RowBox[{"in_", ",", "scaleFunc_", ",", "cutFunc_", ",", "fname_"}], "]"}],
    ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"temp", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temp", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"denomZ2", "[", "#", "]"}]}], "}"}], "&"}], ",", 
         RowBox[{"Select", "[", 
          RowBox[{"in", ",", "cutFunc"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"out", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"toSage", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{"miEmbedQ2", "[", 
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"CForm", "[", 
                RowBox[{"scaleFunc", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"intensityZ2", "[", 
                   RowBox[{"Part", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
                "]"}]}], "}"}], "&"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Select", "[", 
             RowBox[{"temp", ",", 
              RowBox[{
               RowBox[{"visiblity3FreeZ2", "[", 
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.620989878278996*^9, 3.620989910774063*^9}, {
   3.620989973149378*^9, 3.620989974490266*^9}, {3.620990008107634*^9, 
   3.620990039849306*^9}, {3.620990095175259*^9, 3.620990153410439*^9}, {
   3.62099019097882*^9, 3.620990205105979*^9}, {3.620991813999179*^9, 
   3.620991831794714*^9}, {3.6209919238385468`*^9, 3.6209919260950623`*^9}, 
   3.620992159892481*^9, {3.620992346625567*^9, 3.6209924204120617`*^9}, {
   3.620992976375181*^9, 3.6209929859543962`*^9}, {3.620994136090766*^9, 
   3.62099414954241*^9}, {3.6210676183685513`*^9, 3.6210676193881197`*^9}, {
   3.621067683427373*^9, 3.621067686253282*^9}, {3.621068207573792*^9, 
   3.6210682778012133`*^9}, {3.621163350434177*^9, 3.6211633578692636`*^9}, {
   3.6212469751617813`*^9, 3.621246986717227*^9}, {3.62219793696583*^9, 
   3.622197951463861*^9}, {3.622198022284807*^9, 3.622198028609775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AlwaysTrue", "[", "x_", "]"}], ":=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.620117965589262*^9, 3.62011797582959*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testCutZ2", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"N", "[", 
      RowBox[{"miEmbedQ2", "[", "x", "]"}], "]"}], "]"}], "\[LessEqual]", 
    "1.2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.620117993067871*^9, 3.620118103747691*^9}, {
   3.6201215877623463`*^9, 3.620121588473424*^9}, 3.620121711814685*^9, {
   3.620129125351907*^9, 3.620129126929195*^9}, {3.622197954644436*^9, 
   3.622197956927393*^9}, {3.622198034604041*^9, 3.622198036106456*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Point", " ", "against", " ", "line", " ", "clipping", " ", 
    RowBox[{"test", ".", " ", "Line"}], " ", "is", " ", "defined"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"by", " ", 
    RowBox[{"(", 
     RowBox[{"p0", ",", "p1"}], ")"}], " ", "and", " ", "the", " ", "point", 
    " ", "tested", " ", 
    RowBox[{"is", " ", "'"}], 
    RowBox[{
     RowBox[{"t", "'"}], "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"clipLinePoint", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p0x_", ",", "p0y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1x_", ",", "p1y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"tx_", ",", "ty_"}], "}"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p1x", "-", " ", "p0x"}], ")"}], " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{"ty", " ", "-", " ", "p0y"}], ")"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p1y", " ", "-", " ", "p0y"}], ")"}], " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{"tx", " ", "-", " ", "p0x"}], ")"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.621080504971532*^9, 3.621080507968267*^9}, {
  3.621080544499756*^9, 3.621080591219948*^9}, {3.6210806652642403`*^9, 
  3.62108072036553*^9}, {3.621082576150899*^9, 3.6210826222757196`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lvec1Z2", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", 
     RowBox[{"1", "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lvec2Z2", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", "2", "]"}], "/", "4"}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], "/", "4"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clipEps", "=", "0.0001"}], ";"}]}], "Input",
 CellChangeTimes->{{3.62108179631609*^9, 3.621081813462964*^9}, {
  3.621081851218555*^9, 3.621081857617579*^9}, {3.6221980910492373`*^9, 
  3.622198092955473*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Box", " ", "clipping", " ", "test"}], ",", " ", 
    RowBox[{
    "currently", " ", "using", " ", "the", " ", "basis", " ", "vectors", " ", 
     "of", " ", "the", " ", "reciprocal", " ", 
     RowBox[{"lattice", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Two", " ", "times", " ", "two", " ", "fundamental", " ", "domains", " ", 
    "are", " ", 
    RowBox[{"cut", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"clipCutZ2", "[", "x_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "y", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y", "=", 
        RowBox[{"N", "[", 
         RowBox[{"miEmbedQ2", "[", "x", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"clipEps", "+", 
           RowBox[{"clipLinePoint", "[", 
            RowBox[{
             RowBox[{"lvec2Z2", "+", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"lvec2Z2", "+", "lvec1Z2"}], ",", "y"}], "]"}]}], "<", 
          "0"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"clipEps", "+", 
           RowBox[{"clipLinePoint", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "lvec2Z2"}], "+", "lvec1Z2"}], ",", 
             RowBox[{
              RowBox[{"-", "lvec2Z2"}], "+", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "y"}], "]"}]}], "<", 
          "0"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"clipEps", "+", 
           RowBox[{"clipLinePoint", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "lvec1Z2"}], "+", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"-", "lvec1Z2"}], "+", "lvec2Z2"}], ",", "y"}], "]"}]}],
           "<", "0"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"clipEps", "+", 
           RowBox[{"clipLinePoint", "[", 
            RowBox[{
             RowBox[{"lvec1Z2", "+", "lvec2Z2"}], ",", 
             RowBox[{"lvec1Z2", "+", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "y"}], "]"}]}], "<", 
          "0"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.621080494178524*^9, 3.621080502213068*^9}, {
  3.6210807674829206`*^9, 3.621080784746286*^9}, {3.6210808300050077`*^9, 
  3.621080884137536*^9}, {3.621081112529194*^9, 3.621081117921568*^9}, {
  3.6210812560441093`*^9, 3.621081275656898*^9}, {3.621081327642828*^9, 
  3.6210814308698483`*^9}, {3.6210814656214333`*^9, 3.621081519061103*^9}, {
  3.621081670708932*^9, 3.621081674895184*^9}, {3.6210817072729816`*^9, 
  3.6210817090601*^9}, {3.621081748315422*^9, 3.621081775097354*^9}, {
  3.621081820619071*^9, 3.621081824231468*^9}, {3.621081863795122*^9, 
  3.621081916954371*^9}, {3.621082024504427*^9, 3.6210821366109037`*^9}, {
  3.621082527935652*^9, 3.621082531467969*^9}, {3.621082637530993*^9, 
  3.621082670132202*^9}, {3.6210827015522013`*^9, 3.621082707457958*^9}, {
  3.622198049993599*^9, 3.622198052817082*^9}, {3.62219809646565*^9, 
  3.622198112064392*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"intensityPlotZ2", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"vTableQ2", "[", 
        RowBox[{"6", ",", "10"}], "]"}], ",", "qCoprime"}], "]"}], ",", 
     RowBox[{
      RowBox[{"#", "*", "0.2"}], "&"}], ",", "AlwaysTrue"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.620118245040991*^9, 3.6201182472325993`*^9}, {
  3.620118277685033*^9, 3.620118303680972*^9}, {3.6211625883777933`*^9, 
  3.621162608489716*^9}, {3.62219812130739*^9, 3.622198121610158*^9}, {
  3.62219889483853*^9, 3.6221988962045813`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"intensityPlotZ2", "[", 
    RowBox[{
     RowBox[{"vTableQ2RecipAlt", "[", 
      RowBox[{"18", ",", "14"}], "]"}], ",", 
     RowBox[{
      RowBox[{"0.4", "*", "#"}], "&"}], ",", "testCutZ2"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"PointSize", "[", "Large", "]"}], ",", 
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Sqrt", "[", "2", "]"}], "/", "4"}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], "/", "4"}]}], "}"}]}], "}"}], 
       "]"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6201161448500633`*^9, 3.620116160499496*^9}, {
   3.620116955029004*^9, 3.6201169706775723`*^9}, {3.6201170070087748`*^9, 
   3.620117139390176*^9}, {3.620117215834917*^9, 3.620117224091866*^9}, {
   3.620117576363812*^9, 3.62011759973978*^9}, {3.620117657165621*^9, 
   3.6201176595285177`*^9}, {3.620117898175252*^9, 3.620117929472425*^9}, 
   3.620117979004217*^9, {3.620118041755608*^9, 3.620118042986396*^9}, 
   3.6201180746666307`*^9, {3.6201181151608753`*^9, 3.6201181612496967`*^9}, {
   3.6201204413759613`*^9, 3.620120464223851*^9}, {3.6201205191802387`*^9, 
   3.620120521308117*^9}, {3.620121114866826*^9, 3.6201211597770576`*^9}, {
   3.6201211985621223`*^9, 3.6201212014736*^9}, {3.620121383913541*^9, 
   3.620121384424704*^9}, {3.6201215373344517`*^9, 3.620121538038653*^9}, 
   3.620121616047902*^9, {3.6201216688605423`*^9, 3.620121716301358*^9}, {
   3.62012777264253*^9, 3.6201278333923483`*^9}, {3.620128206874262*^9, 
   3.620128231922123*^9}, 3.620128533714073*^9, 3.620129084840785*^9, {
   3.6201291439681377`*^9, 3.620129144336594*^9}, {3.620129300682604*^9, 
   3.620129306682229*^9}, 3.620129386648818*^9, {3.620130068922127*^9, 
   3.620130077050988*^9}, {3.620130109770102*^9, 3.620130112342918*^9}, {
   3.620130143769002*^9, 3.6201301452720137`*^9}, {3.6209897772329683`*^9, 
   3.620989778318026*^9}, 3.620989813477091*^9, {3.62108089273999*^9, 
   3.621080895575734*^9}, {3.621162614443275*^9, 3.621162614865656*^9}, {
   3.6211628851527767`*^9, 3.621162887503457*^9}, {3.621162970349412*^9, 
   3.621162975978207*^9}, {3.62219812303227*^9, 3.6221981233274593`*^9}, {
   3.622198761448387*^9, 3.622198761713953*^9}, {3.622198900071968*^9, 
   3.622198901364193*^9}}],

Cell[BoxData[
 RowBox[{"intensityPlotZ2", "[", 
  RowBox[{
   RowBox[{"vTableQ2RecipAlt", "[", 
    RowBox[{"20", ",", "16"}], "]"}], ",", 
   RowBox[{
    RowBox[{"0.4", "*", "#"}], "&"}], ",", "clipCutZ2"}], "]"}]], "Input",
 CellChangeTimes->{{3.621080900423984*^9, 3.621080901416038*^9}, {
   3.621081160456046*^9, 3.621081162670691*^9}, {3.621081535999033*^9, 
   3.621081537408512*^9}, {3.621082146931684*^9, 3.6210821585655727`*^9}, {
   3.621082206744178*^9, 3.621082209510984*^9}, {3.621162924591284*^9, 
   3.621162941044014*^9}, {3.621246897048814*^9, 3.621246907926415*^9}, 
   3.6212469992696037`*^9, {3.622198764213282*^9, 3.622198775505205*^9}}],

Cell[BoxData[
 RowBox[{"intensityExportZ2", "[", 
  RowBox[{
   RowBox[{"vTableQ2RecipAlt", "[", 
    RowBox[{"20", ",", "16"}], "]"}], ",", 
   RowBox[{
    RowBox[{"#", "*", "0.4"}], "&"}], ",", "clipCutZ2", ",", 
   "\"\</homes/tjakobi/out_sage.txt\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.620990054996623*^9, 3.6209900769023333`*^9}, {
   3.620991739588874*^9, 3.620991771167201*^9}, {3.620991839110682*^9, 
   3.620991842194571*^9}, 3.62099192959527*^9, {3.620992313515915*^9, 
   3.6209923337089767`*^9}, {3.6209924254313107`*^9, 3.620992430987856*^9}, 
   3.620993012878498*^9, {3.620994067400754*^9, 3.620994071569393*^9}, {
   3.62106751444954*^9, 3.621067517263239*^9}, {3.6210676382564774`*^9, 
   3.621067639160514*^9}, {3.621068445901634*^9, 3.621068446155315*^9}, {
   3.621082234052886*^9, 3.62108223938076*^9}, {3.621163470469193*^9, 
   3.621163474947589*^9}, {3.622198776742076*^9, 3.622198782827232*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"checkCircleZ2", "[", 
    RowBox[{"in_", ",", "max_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "mi", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mi", "=", 
       RowBox[{"miEmbedZ2", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"Norm", "[", "mi", "]"}], "]"}], "\[LessEqual]", "max"}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cutCircleZ2", "[", 
    RowBox[{"in_", ",", "max_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"in", ",", 
     RowBox[{
      RowBox[{"checkCircleZ2", "[", 
       RowBox[{"#", ",", "max"}], "]"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.625573758255946*^9, 3.6255737584587727`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"vDrawZ2", "[", 
    RowBox[{"cutCircleZ2", "[", 
     RowBox[{
      RowBox[{"vTableZ2", "[", "50", "]"}], ",", 
      RowBox[{"50", "*", 
       RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}], "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1.0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.625573775102085*^9, 3.625573777662198*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\</homes/tjakobi/PhD_Work/radialprojection\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"dataExternZ2", "=", 
    RowBox[{"RunThrough", "[", 
     RowBox[{"\"\<./arith_visibility 1\>\"", ",", "Null"}], "]"}]}], ";"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.625573792609556*^9, 3.625573804286038*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"vDrawZ2", "[", "dataExternZ2", "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1.0"}]}], "]"}]], "Input",
 CellChangeTimes->{3.625573806779484*^9}]
},
WindowSize->{1920, 1145},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 402, 9, 38, "Input"],
Cell[962, 31, 188, 6, 38, "Input"],
Cell[1153, 39, 137, 2, 38, "Input"],
Cell[1293, 43, 779, 23, 64, "Input"],
Cell[2075, 68, 2435, 62, 189, "Input"],
Cell[4513, 132, 2114, 62, 139, "Input"],
Cell[6630, 196, 743, 18, 64, "Input"],
Cell[7376, 216, 452, 10, 64, "Input"],
Cell[7831, 228, 690, 14, 89, "Input"],
Cell[8524, 244, 719, 22, 64, "Input"],
Cell[9246, 268, 1885, 59, 114, "Input"],
Cell[11134, 329, 843, 26, 64, "Input"],
Cell[11980, 357, 3470, 81, 239, "Input"],
Cell[15453, 440, 1181, 27, 80, "Input"],
Cell[16637, 469, 3983, 98, 392, "Input"],
Cell[20623, 569, 346, 8, 38, "Input"],
Cell[20972, 579, 1360, 36, 64, "Input"],
Cell[22335, 617, 1443, 37, 89, "Input"],
Cell[23781, 656, 1180, 26, 64, "Input"],
Cell[24964, 684, 494, 11, 38, "Input"],
Cell[25461, 697, 898, 23, 89, "Input"],
Cell[26362, 722, 485, 13, 38, "Input"],
Cell[26850, 737, 430, 9, 38, "Input"],
Cell[27283, 748, 1238, 24, 38, "Input"],
Cell[28524, 774, 637, 16, 38, "Input"],
Cell[29164, 792, 971, 27, 64, "Input"],
Cell[30138, 821, 418, 9, 38, "Input"],
Cell[30559, 832, 1020, 23, 64, "Input"],
Cell[31582, 857, 695, 18, 38, "Input"],
Cell[32280, 877, 335, 9, 38, "Input"],
Cell[32618, 888, 675, 16, 64, "Input"],
Cell[33296, 906, 415, 10, 38, "Input"],
Cell[33714, 918, 288, 7, 38, "Input"],
Cell[34005, 927, 2345, 60, 214, "Input"],
Cell[36353, 989, 1771, 47, 189, "Input"],
Cell[38127, 1038, 2384, 61, 189, "Input"],
Cell[40514, 1101, 1302, 31, 114, "Input"],
Cell[41819, 1134, 4439, 100, 289, "Input"],
Cell[46261, 1236, 595, 19, 64, "Input"],
Cell[46859, 1257, 378, 7, 38, "Input"],
Cell[47240, 1266, 568, 17, 38, "Input"],
Cell[47811, 1285, 521, 12, 64, "Input"],
Cell[48335, 1299, 553, 13, 64, "Input"],
Cell[48891, 1314, 2754, 72, 214, "Input"],
Cell[51648, 1388, 2676, 70, 139, "Input"],
Cell[54327, 1460, 2295, 63, 114, "Input"],
Cell[56625, 1525, 2034, 55, 89, "Input"],
Cell[58662, 1582, 1777, 44, 64, "Input"],
Cell[60442, 1628, 410, 11, 64, "Input"],
Cell[60855, 1641, 492, 10, 38, "Input"],
Cell[61350, 1653, 359, 9, 38, "Input"],
Cell[61712, 1664, 210, 4, 38, "Input"],
Cell[61925, 1670, 3051, 76, 239, "Input"],
Cell[64979, 1748, 979, 24, 64, "Input"],
Cell[65961, 1774, 5210, 121, 339, "Input"],
Cell[71174, 1897, 441, 10, 64, "Input"],
Cell[71618, 1909, 1466, 40, 89, "Input"],
Cell[73087, 1951, 1344, 38, 89, "Input"],
Cell[74434, 1991, 3400, 67, 189, "Input"],
Cell[77837, 2060, 729, 17, 64, "Input"],
Cell[78569, 2079, 2846, 63, 189, "Input"],
Cell[81418, 2144, 175, 4, 38, "Input"],
Cell[81596, 2150, 538, 12, 38, "Input"],
Cell[82137, 2164, 1443, 38, 114, "Input"],
Cell[83583, 2204, 693, 21, 89, "Input"],
Cell[84279, 2227, 3888, 95, 264, "Input"],
Cell[88170, 2324, 863, 23, 64, "Input"],
Cell[89036, 2349, 2781, 56, 64, "Input"],
Cell[91820, 2407, 660, 12, 38, "Input"],
Cell[92483, 2421, 929, 16, 38, "Input"],
Cell[93415, 2439, 888, 25, 114, "Input"],
Cell[94306, 2466, 393, 10, 38, "Input"],
Cell[94702, 2478, 416, 11, 64, "Input"],
Cell[95121, 2491, 210, 5, 38, "Input"]
}
]
*)

(* End of internal cache information *)
